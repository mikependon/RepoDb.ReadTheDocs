

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Connection &mdash; RepoDb 1.1.0 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../_static/jquery.js"></script>
        <script type="text/javascript" src="../_static/underscore.js"></script>
        <script type="text/javascript" src="../_static/doctools.js"></script>
        <script type="text/javascript" src="../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Raw SQL" href="rawsql.html" />
    <link rel="prev" title="OrderField" href="orderfield.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> RepoDb
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="attributes.html">Attributes</a></li>
<li class="toctree-l1"><a class="reference internal" href="typemapping.html">Type Mapping</a></li>
<li class="toctree-l1"><a class="reference internal" href="propertyhandler.html">Property Handler</a></li>
<li class="toctree-l1"><a class="reference internal" href="field.html">Field</a></li>
<li class="toctree-l1"><a class="reference internal" href="orderfield.html">OrderField</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Connection</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#average">Average</a></li>
<li class="toctree-l2"><a class="reference internal" href="#averageall">AverageAll</a></li>
<li class="toctree-l2"><a class="reference internal" href="#batchquery">BatchQuery</a></li>
<li class="toctree-l2"><a class="reference internal" href="#bulkdelete">BulkDelete</a></li>
<li class="toctree-l2"><a class="reference internal" href="#bulkinsert">BulkInsert</a></li>
<li class="toctree-l2"><a class="reference internal" href="#bulkmerge">BulkMerge</a></li>
<li class="toctree-l2"><a class="reference internal" href="#bulkupdate">BulkUpdate</a></li>
<li class="toctree-l2"><a class="reference internal" href="#count">Count</a></li>
<li class="toctree-l2"><a class="reference internal" href="#countall">CountAll</a></li>
<li class="toctree-l2"><a class="reference internal" href="#createcommand">CreateCommand</a></li>
<li class="toctree-l2"><a class="reference internal" href="#delete">Delete</a></li>
<li class="toctree-l2"><a class="reference internal" href="#deleteall">DeleteAll</a></li>
<li class="toctree-l2"><a class="reference internal" href="#ensureopen">EnsureOpen</a></li>
<li class="toctree-l2"><a class="reference internal" href="#executenonquery">ExecuteNonQuery</a></li>
<li class="toctree-l2"><a class="reference internal" href="#executequery">ExecuteQuery</a></li>
<li class="toctree-l2"><a class="reference internal" href="#executequerymultiple">ExecuteQueryMultiple</a></li>
<li class="toctree-l2"><a class="reference internal" href="#executereader">ExecuteReader</a></li>
<li class="toctree-l2"><a class="reference internal" href="#executescalar">ExecuteScalar</a></li>
<li class="toctree-l2"><a class="reference internal" href="#exists">Exists</a></li>
<li class="toctree-l2"><a class="reference internal" href="#getdbsetting">GetDbSetting</a></li>
<li class="toctree-l2"><a class="reference internal" href="#getdbhelper">GetDbHelper</a></li>
<li class="toctree-l2"><a class="reference internal" href="#getstatementbuilder">GetStatementBuilder</a></li>
<li class="toctree-l2"><a class="reference internal" href="#insert">Insert</a></li>
<li class="toctree-l2"><a class="reference internal" href="#insertall">InsertAll</a></li>
<li class="toctree-l2"><a class="reference internal" href="#max">Max</a></li>
<li class="toctree-l2"><a class="reference internal" href="#maxall">MaxAll</a></li>
<li class="toctree-l2"><a class="reference internal" href="#merge">Merge</a></li>
<li class="toctree-l2"><a class="reference internal" href="#mergeall">MergeAll</a></li>
<li class="toctree-l2"><a class="reference internal" href="#min">Min</a></li>
<li class="toctree-l2"><a class="reference internal" href="#minall">MinAll</a></li>
<li class="toctree-l2"><a class="reference internal" href="#query">Query</a></li>
<li class="toctree-l2"><a class="reference internal" href="#queryall">QueryAll</a></li>
<li class="toctree-l2"><a class="reference internal" href="#querymultiple">QueryMultiple</a></li>
<li class="toctree-l2"><a class="reference internal" href="#sum">Sum</a></li>
<li class="toctree-l2"><a class="reference internal" href="#sumall">SumAll</a></li>
<li class="toctree-l2"><a class="reference internal" href="#truncate">Truncate</a></li>
<li class="toctree-l2"><a class="reference internal" href="#update">Update</a></li>
<li class="toctree-l2"><a class="reference internal" href="#updateall">UpdateAll</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="rawsql.html">Raw SQL</a></li>
<li class="toctree-l1"><a class="reference internal" href="enumeration.html">Enumeration</a></li>
<li class="toctree-l1"><a class="reference internal" href="dbhelper.html">DB Helper</a></li>
<li class="toctree-l1"><a class="reference internal" href="hints.html">Hints</a></li>
<li class="toctree-l1"><a class="reference internal" href="transaction.html">Transaction</a></li>
<li class="toctree-l1"><a class="reference internal" href="querygroup.html">QueryGroup</a></li>
<li class="toctree-l1"><a class="reference internal" href="repository.html">Repository</a></li>
<li class="toctree-l1"><a class="reference internal" href="persistency.html">Persistency</a></li>
<li class="toctree-l1"><a class="reference internal" href="cache.html">Cache</a></li>
<li class="toctree-l1"><a class="reference internal" href="trace.html">Trace</a></li>
<li class="toctree-l1"><a class="reference internal" href="dbsetting.html">DB Setting</a></li>
<li class="toctree-l1"><a class="reference internal" href="statementbuilder.html">StatementBuilder</a></li>
<li class="toctree-l1"><a class="reference internal" href="performance.html">Performance</a></li>
<li class="toctree-l1"><a class="reference internal" href="extensibility.html">Extensibility</a></li>
<li class="toctree-l1"><a class="reference internal" href="support.html">Supports</a></li>
<li class="toctree-l1"><a class="reference internal" href="contact.html">Contacts</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">RepoDb</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
      <li>Connection</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/pages/connection.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="connection">
<h1>Connection<a class="headerlink" href="#connection" title="Permalink to this headline">¶</a></h1>
<p>The library has abstracted everything from <cite>ADO.NET</cite> when it comes to the connection object.</p>
<p><strong>Note</strong>: All the operations provided has an equivalent <cite>Async</cite> and/or <cite>TableName</cite> methods.</p>
<div class="section" id="average">
<h2>Average<a class="headerlink" href="#average" title="Permalink to this headline">¶</a></h2>
<p>Averages the target field from the database table.</p>
<p>Dynamic way:</p>
<div class="highlight-c# notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">connection</span> <span class="p">=</span> <span class="k">new</span> <span class="n">SqlConnection</span><span class="p">&gt;(</span><span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">).</span><span class="n">EnsureOpen</span><span class="p">())</span>
<span class="p">{</span>
        <span class="kt">var</span> <span class="n">result</span> <span class="p">=</span> <span class="n">connection</span><span class="p">.</span><span class="n">Average</span><span class="p">&lt;</span><span class="n">Order</span><span class="p">&gt;(</span><span class="n">e</span> <span class="p">=&gt;</span> <span class="n">e</span><span class="p">.</span><span class="n">Price</span><span class="p">,</span>
                <span class="k">new</span> <span class="p">{</span> <span class="n">CustomerId</span> <span class="p">=</span> <span class="m">10045</span><span class="p">,</span> <span class="n">OrderDate</span> <span class="p">=</span> <span class="n">DateTime</span><span class="p">.</span><span class="n">UtcNow</span><span class="p">.</span><span class="n">Date</span> <span class="p">});</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div>
<p>Expression way:</p>
<div class="highlight-c# notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">connection</span> <span class="p">=</span> <span class="k">new</span> <span class="n">SqlConnection</span><span class="p">&gt;(</span><span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">).</span><span class="n">EnsureOpen</span><span class="p">())</span>
<span class="p">{</span>
        <span class="kt">var</span> <span class="n">result</span> <span class="p">=</span> <span class="n">connection</span><span class="p">.</span><span class="n">Average</span><span class="p">&lt;</span><span class="n">Order</span><span class="p">&gt;(</span><span class="n">e</span> <span class="p">=&gt;</span> <span class="n">e</span><span class="p">.</span><span class="n">Price</span><span class="p">,</span>
                <span class="n">e</span> <span class="p">=&gt;</span> <span class="n">e</span><span class="p">.</span><span class="n">CustomerId</span> <span class="p">==</span> <span class="m">10045</span> <span class="p">&amp;&amp;</span> <span class="n">e</span><span class="p">.</span><span class="n">OrderDate</span> <span class="p">==</span> <span class="n">DateTime</span><span class="p">.</span><span class="n">UtcNow</span><span class="p">.</span><span class="n">Date</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div>
<p>Explicit way:</p>
<div class="highlight-c# notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8
9</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">connection</span> <span class="p">=</span> <span class="k">new</span> <span class="n">SqlConnection</span><span class="p">&gt;(</span><span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">).</span><span class="n">EnsureOpen</span><span class="p">())</span>
<span class="p">{</span>
        <span class="kt">var</span> <span class="n">queryGroup</span> <span class="p">=</span> <span class="k">new</span> <span class="n">QueryGroup</span>
        <span class="p">(</span>
                <span class="k">new</span> <span class="nf">QueryField</span><span class="p">(</span><span class="n">nameof</span><span class="p">(</span><span class="n">Order</span><span class="p">.</span><span class="n">CustomerId</span><span class="p">),</span> <span class="m">10045</span><span class="p">),</span>
                <span class="k">new</span> <span class="nf">QueryField</span><span class="p">(</span><span class="n">nameof</span><span class="p">(</span><span class="n">Order</span><span class="p">.</span><span class="n">OrderDate</span><span class="p">),</span> <span class="n">DateTime</span><span class="p">.</span><span class="n">UtcNow</span><span class="p">.</span><span class="n">Date</span><span class="p">)</span>
        <span class="p">);</span>
        <span class="kt">var</span> <span class="n">result</span> <span class="p">=</span> <span class="n">connection</span><span class="p">.</span><span class="n">Average</span><span class="p">&lt;</span><span class="n">Order</span><span class="p">&gt;(</span><span class="n">e</span> <span class="p">=&gt;</span> <span class="n">e</span><span class="p">.</span><span class="n">Price</span><span class="p">,</span> <span class="n">queryGroup</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div>
<p>Records can all also be averaged via table name.</p>
<p>Dynamic way:</p>
<div class="highlight-c# notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">connection</span> <span class="p">=</span> <span class="k">new</span> <span class="n">SqlConnection</span><span class="p">&gt;(</span><span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">).</span><span class="n">EnsureOpen</span><span class="p">())</span>
<span class="p">{</span>
        <span class="kt">var</span> <span class="n">result</span> <span class="p">=</span> <span class="n">connection</span><span class="p">.</span><span class="n">Average</span><span class="p">(</span><span class="s">&quot;Order&quot;</span><span class="p">,</span> <span class="k">new</span> <span class="n">Field</span><span class="p">(</span><span class="s">&quot;Price&quot;</span><span class="p">),</span> <span class="k">new</span> <span class="p">{</span> <span class="n">CustomerId</span> <span class="p">=</span> <span class="m">10045</span> <span class="p">});</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div>
<p>Explicit way:</p>
<div class="highlight-c# notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8
9</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">connection</span> <span class="p">=</span> <span class="k">new</span> <span class="n">SqlConnection</span><span class="p">&gt;(</span><span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">).</span><span class="n">EnsureOpen</span><span class="p">())</span>
<span class="p">{</span>
        <span class="kt">var</span> <span class="n">queryGroup</span> <span class="p">=</span> <span class="k">new</span> <span class="n">QueryGroup</span>
        <span class="p">(</span>
                <span class="k">new</span> <span class="nf">QueryField</span><span class="p">(</span><span class="n">nameof</span><span class="p">(</span><span class="n">Order</span><span class="p">.</span><span class="n">CustomerId</span><span class="p">),</span> <span class="m">10045</span><span class="p">),</span>
                <span class="k">new</span> <span class="nf">QueryField</span><span class="p">(</span><span class="n">nameof</span><span class="p">(</span><span class="n">Order</span><span class="p">.</span><span class="n">OrderDate</span><span class="p">),</span> <span class="n">DateTime</span><span class="p">.</span><span class="n">UtcNow</span><span class="p">.</span><span class="n">Date</span><span class="p">)</span>
        <span class="p">);</span>
        <span class="kt">var</span> <span class="n">result</span> <span class="p">=</span> <span class="n">connection</span><span class="p">.</span><span class="n">Average</span><span class="p">(</span><span class="s">&quot;Order&quot;</span><span class="p">,</span> <span class="k">new</span> <span class="n">Field</span><span class="p">(</span><span class="s">&quot;Price&quot;</span><span class="p">),</span> <span class="n">queryGroup</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div>
<p><strong>Note</strong>: By setting the <cite>where</cite> argument to blank would average all the records. Exactly the same as <cite>AverageAll</cite> operation.</p>
</div>
<div class="section" id="averageall">
<h2>AverageAll<a class="headerlink" href="#averageall" title="Permalink to this headline">¶</a></h2>
<p>Averages the target field from all data of the database table.</p>
<div class="highlight-c# notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">connection</span> <span class="p">=</span> <span class="k">new</span> <span class="n">SqlConnection</span><span class="p">&gt;(</span><span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">).</span><span class="n">EnsureOpen</span><span class="p">())</span>
<span class="p">{</span>
        <span class="kt">var</span> <span class="n">result</span> <span class="p">=</span> <span class="n">connection</span><span class="p">.</span><span class="n">AverageAll</span><span class="p">&lt;</span><span class="n">Order</span><span class="p">&gt;(</span><span class="n">e</span> <span class="p">=&gt;</span> <span class="n">e</span><span class="p">.</span><span class="n">Price</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div>
<p>All records can all also be averaged via table name.</p>
<p>Dynamic way:</p>
<div class="highlight-c# notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">connection</span> <span class="p">=</span> <span class="k">new</span> <span class="n">SqlConnection</span><span class="p">&gt;(</span><span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">).</span><span class="n">EnsureOpen</span><span class="p">())</span>
<span class="p">{</span>
        <span class="kt">var</span> <span class="n">result</span> <span class="p">=</span> <span class="n">connection</span><span class="p">.</span><span class="n">AverageAll</span><span class="p">(</span><span class="s">&quot;Order&quot;</span><span class="p">,</span> <span class="k">new</span> <span class="n">Field</span><span class="p">(</span><span class="s">&quot;Price&quot;</span><span class="p">));</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="batchquery">
<h2>BatchQuery<a class="headerlink" href="#batchquery" title="Permalink to this headline">¶</a></h2>
<p>Queries a data from the database by batch.</p>
<p>Dynamic way:</p>
<div class="highlight-c# notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">connection</span> <span class="p">=</span> <span class="k">new</span> <span class="n">SqlConnection</span><span class="p">&gt;(</span><span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">).</span><span class="n">EnsureOpen</span><span class="p">())</span>
<span class="p">{</span>
        <span class="n">connection</span><span class="p">.</span><span class="n">BatchQuery</span><span class="p">&lt;</span><span class="n">Order</span><span class="p">&gt;(</span><span class="m">0</span><span class="p">,</span>
                <span class="m">24</span><span class="p">,</span>
                <span class="n">OrderField</span><span class="p">.</span><span class="n">Parse</span><span class="p">(</span><span class="k">new</span> <span class="p">{</span> <span class="n">Id</span> <span class="p">=</span> <span class="n">Order</span><span class="p">.</span><span class="n">Ascending</span> <span class="p">}),</span>
                <span class="k">new</span> <span class="p">{</span> <span class="n">CustomerId</span> <span class="p">=</span> <span class="m">10045</span> <span class="p">});</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div>
<p>Expression way:</p>
<div class="highlight-c# notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">connection</span> <span class="p">=</span> <span class="k">new</span> <span class="n">SqlConnection</span><span class="p">&gt;(</span><span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">).</span><span class="n">EnsureOpen</span><span class="p">())</span>
<span class="p">{</span>
        <span class="n">connection</span><span class="p">.</span><span class="n">BatchQuery</span><span class="p">&lt;</span><span class="n">Order</span><span class="p">&gt;(</span><span class="m">0</span><span class="p">,</span>
                <span class="m">24</span><span class="p">,</span>
                <span class="n">OrderField</span><span class="p">.</span><span class="n">Ascending</span><span class="p">&lt;</span><span class="n">Order</span><span class="p">&gt;(</span><span class="n">o</span> <span class="p">=&gt;</span> <span class="n">o</span><span class="p">.</span><span class="n">Id</span><span class="p">),</span>
                <span class="n">o</span> <span class="p">=&gt;</span> <span class="n">o</span><span class="p">.</span><span class="n">CustomerId</span> <span class="p">=</span> <span class="m">10045</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div>
<p>Explicit way:</p>
<div class="highlight-c# notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">connection</span> <span class="p">=</span> <span class="k">new</span> <span class="n">SqlConnection</span><span class="p">&gt;(</span><span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">).</span><span class="n">EnsureOpen</span><span class="p">())</span>
<span class="p">{</span>
        <span class="n">connection</span><span class="p">.</span><span class="n">BatchQuery</span><span class="p">&lt;</span><span class="n">Order</span><span class="p">&gt;(</span><span class="m">0</span><span class="p">,</span>
                <span class="m">24</span><span class="p">,</span>
                <span class="k">new</span> <span class="nf">OrderField</span><span class="p">(</span><span class="s">&quot;Id&quot;</span><span class="p">,</span> <span class="n">Order</span><span class="p">.</span><span class="n">Ascending</span><span class="p">).</span><span class="n">AsEnumerable</span><span class="p">(),</span>
                <span class="k">new</span> <span class="nf">QueryField</span><span class="p">(</span><span class="n">nameof</span><span class="p">(</span><span class="n">Order</span><span class="p">.</span><span class="n">CustomerId</span><span class="p">),</span> <span class="m">10045</span><span class="p">));</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div>
<p>Targetted columns can also be batch-queried via table-name-based calls.</p>
<p>Dynamic way:</p>
<div class="highlight-c# notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8
9</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">connection</span> <span class="p">=</span> <span class="k">new</span> <span class="n">SqlConnection</span><span class="p">&gt;(</span><span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">).</span><span class="n">EnsureOpen</span><span class="p">())</span>
<span class="p">{</span>
        <span class="n">connection</span><span class="p">.</span><span class="n">BatchQuery</span><span class="p">(</span><span class="s">&quot;Order&quot;</span><span class="p">,</span>
                <span class="m">0</span><span class="p">,</span>
                <span class="m">24</span><span class="p">,</span>
                <span class="k">new</span> <span class="nf">OrderField</span><span class="p">(</span><span class="s">&quot;Id&quot;</span><span class="p">,</span> <span class="n">Order</span><span class="p">.</span><span class="n">Ascending</span><span class="p">).</span><span class="n">AsEnumerable</span><span class="p">(),</span>
                <span class="k">new</span> <span class="p">{</span> <span class="n">CustomerId</span> <span class="p">=</span> <span class="m">10045</span> <span class="p">},</span>
                <span class="n">fields</span><span class="p">:</span> <span class="n">Field</span><span class="p">.</span><span class="n">From</span><span class="p">(</span><span class="s">&quot;Id&quot;</span><span class="p">,</span> <span class="s">&quot;Name&quot;</span><span class="p">,</span> <span class="s">&quot;Address&quot;</span><span class="p">));</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div>
<p>Explicit way:</p>
<div class="highlight-c# notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8
9</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">connection</span> <span class="p">=</span> <span class="k">new</span> <span class="n">SqlConnection</span><span class="p">&gt;(</span><span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">).</span><span class="n">EnsureOpen</span><span class="p">())</span>
<span class="p">{</span>
        <span class="n">connection</span><span class="p">.</span><span class="n">BatchQuery</span><span class="p">(</span><span class="s">&quot;Order&quot;</span><span class="p">,</span>
                <span class="m">0</span><span class="p">,</span>
                <span class="m">24</span><span class="p">,</span>
                <span class="k">new</span> <span class="nf">OrderField</span><span class="p">(</span><span class="s">&quot;Id&quot;</span><span class="p">,</span> <span class="n">Order</span><span class="p">.</span><span class="n">Ascending</span><span class="p">).</span><span class="n">AsEnumerable</span><span class="p">(),</span>
                <span class="k">new</span> <span class="nf">QueryField</span><span class="p">(</span><span class="n">nameof</span><span class="p">(</span><span class="n">Order</span><span class="p">.</span><span class="n">CustomerId</span><span class="p">),</span> <span class="m">10045</span><span class="p">),</span>
                <span class="n">fields</span><span class="p">:</span> <span class="n">Field</span><span class="p">.</span><span class="n">From</span><span class="p">(</span><span class="s">&quot;Id&quot;</span><span class="p">,</span> <span class="s">&quot;Name&quot;</span><span class="p">,</span> <span class="s">&quot;Address&quot;</span><span class="p">));</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="bulkdelete">
<h2>BulkDelete<a class="headerlink" href="#bulkdelete" title="Permalink to this headline">¶</a></h2>
<p>Bulk delete a list of data entity objects from the database.</p>
<p><strong>Note:</strong> <cite>Only at package RepoDb.SqlServer.BulkOperations.</cite></p>
<p>The result would be the number of rows affected by <cite>BulkDelete</cite> operation from the database.</p>
<p>Via DataEntities:</p>
<div class="highlight-c# notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">var</span> <span class="n">orders</span> <span class="p">=</span> <span class="k">new</span> <span class="n">List</span><span class="p">&lt;</span><span class="n">Order</span><span class="p">&gt;();</span>

<span class="n">orders</span><span class="p">.</span><span class="n">Add</span><span class="p">(</span><span class="k">new</span> <span class="n">Order</span><span class="p">()</span>
<span class="p">{</span>
        <span class="n">Id</span> <span class="p">=</span> <span class="m">1</span><span class="p">,</span>
        <span class="p">...</span>
<span class="p">},</span>
<span class="p">...);</span>

<span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">connection</span> <span class="p">=</span> <span class="k">new</span> <span class="n">SqlConnection</span><span class="p">(</span><span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">).</span><span class="n">EnsureOpen</span><span class="p">())</span>
<span class="p">{</span>
        <span class="kt">var</span> <span class="n">result</span> <span class="p">=</span> <span class="n">connection</span><span class="p">.</span><span class="n">BulkDelete</span><span class="p">&lt;</span><span class="n">Order</span><span class="p">&gt;(</span><span class="n">orders</span><span class="p">);</span>
        <span class="c1">// or</span>
        <span class="kt">var</span> <span class="n">result</span> <span class="p">=</span> <span class="n">connection</span><span class="p">.</span><span class="n">BulkDelete</span><span class="p">(</span><span class="s">&quot;Order&quot;</span><span class="p">,</span> <span class="n">orders</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div>
<p>Via DataReader:</p>
<div class="highlight-c# notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">sourceConnection</span> <span class="p">=</span> <span class="k">new</span> <span class="n">SqlConnection</span><span class="p">(</span><span class="s">@&quot;Server=.;Database=Northwind_Old;Integrated Security=SSPI;&quot;</span><span class="p">).</span><span class="n">EnsureOpen</span><span class="p">())</span>
<span class="p">{</span>
        <span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">reader</span> <span class="p">=</span> <span class="n">sourceConnection</span><span class="p">.</span><span class="n">ExecuteReader</span><span class="p">(</span><span class="s">&quot;SELECT Id FROM [dbo].[Order];&quot;</span><span class="p">))</span>
        <span class="p">{</span>
                <span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">destinationConnection</span> <span class="p">=</span> <span class="k">new</span> <span class="n">SqlConnection</span><span class="p">(</span><span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">).</span><span class="n">EnsureOpen</span><span class="p">())</span>
                <span class="p">{</span>
                        <span class="kt">var</span> <span class="n">result</span> <span class="p">=</span> <span class="n">destinationConnection</span><span class="p">.</span><span class="n">BulkDelete</span><span class="p">&lt;</span><span class="n">Order</span><span class="p">&gt;(</span><span class="n">reader</span><span class="p">);</span>
                        <span class="c1">// or</span>
                        <span class="kt">var</span> <span class="n">result</span> <span class="p">=</span> <span class="n">destinationConnection</span><span class="p">.</span><span class="n">BulkDelete</span><span class="p">(</span><span class="s">&quot;Order&quot;</span><span class="p">,</span> <span class="n">reader</span><span class="p">);</span>
                <span class="p">}</span>
        <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div>
<p>Via PrimaryKeys:</p>
<div class="highlight-c# notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">var</span> <span class="n">primaryKeys</span> <span class="p">=</span> <span class="k">new</span><span class="p">[]</span> <span class="p">{</span> <span class="m">10045</span><span class="p">,</span> <span class="m">10077</span><span class="p">,</span> <span class="p">...,</span> <span class="m">10089</span><span class="p">,</span> <span class="m">10092</span> <span class="p">};</span>

<span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">connection</span> <span class="p">=</span> <span class="k">new</span> <span class="n">SqlConnection</span><span class="p">(</span><span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">).</span><span class="n">EnsureOpen</span><span class="p">())</span>
<span class="p">{</span>
        <span class="kt">var</span> <span class="n">result</span> <span class="p">=</span> <span class="n">connection</span><span class="p">.</span><span class="n">BulkDelete</span><span class="p">&lt;</span><span class="n">Order</span><span class="p">&gt;(</span><span class="n">primaryKeys</span><span class="p">);</span>
        <span class="c1">// or</span>
        <span class="kt">var</span> <span class="n">result</span> <span class="p">=</span> <span class="n">connection</span><span class="p">.</span><span class="n">BulkDelete</span><span class="p">(</span><span class="s">&quot;Order&quot;</span><span class="p">,</span> <span class="n">primaryKeys</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div>
<p>Via DataTable:</p>
<div class="highlight-c# notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">var</span> <span class="n">ordersTable</span> <span class="p">=</span> <span class="n">GetOrdersDataTable</span><span class="p">();</span>

<span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">connection</span> <span class="p">=</span> <span class="k">new</span> <span class="n">SqlConnection</span><span class="p">(</span><span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">).</span><span class="n">EnsureOpen</span><span class="p">())</span>
<span class="p">{</span>
        <span class="kt">var</span> <span class="n">result</span> <span class="p">=</span> <span class="n">connection</span><span class="p">.</span><span class="n">BulkDelete</span><span class="p">&lt;</span><span class="n">Order</span><span class="p">&gt;(</span><span class="n">ordersTable</span><span class="p">);</span>
        <span class="c1">// or</span>
        <span class="kt">var</span> <span class="n">result</span> <span class="p">=</span> <span class="n">connection</span><span class="p">.</span><span class="n">BulkDelete</span><span class="p">(</span><span class="s">&quot;Order&quot;</span><span class="p">,</span> <span class="n">ordersTable</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="bulkinsert">
<h2>BulkInsert<a class="headerlink" href="#bulkinsert" title="Permalink to this headline">¶</a></h2>
<p>Bulk insert a list of data entity objects into the database.</p>
<p><strong>Note:</strong> <cite>Only at package RepoDb.SqlServer.BulkOperations.</cite></p>
<p>The result would be the number of rows inserted by the <cite>BulkInsert</cite> operation in the database.</p>
<p>Via DataEntities:</p>
<div class="highlight-c# notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">var</span> <span class="n">orders</span> <span class="p">=</span> <span class="k">new</span> <span class="n">List</span><span class="p">&lt;</span><span class="n">Order</span><span class="p">&gt;();</span>

<span class="n">orders</span><span class="p">.</span><span class="n">Add</span><span class="p">(</span><span class="k">new</span> <span class="n">Order</span><span class="p">()</span>
<span class="p">{</span>
        <span class="n">Quantity</span> <span class="p">=</span> <span class="m">2</span><span class="p">,</span>
        <span class="n">ProductId</span> <span class="p">=</span> <span class="m">12</span><span class="p">,</span>
        <span class="n">CreatedDate</span> <span class="p">=</span> <span class="n">DateTime</span><span class="p">.</span><span class="n">UtcNow</span><span class="p">,</span>
        <span class="n">UpdatedDate</span> <span class="p">=</span> <span class="n">DateTime</span><span class="p">.</span><span class="n">UtcNow</span>
<span class="p">},</span>
<span class="p">...);</span>

<span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">connection</span> <span class="p">=</span> <span class="k">new</span> <span class="n">SqlConnection</span><span class="p">(</span><span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">).</span><span class="n">EnsureOpen</span><span class="p">())</span>
<span class="p">{</span>
        <span class="kt">var</span> <span class="n">result</span> <span class="p">=</span> <span class="n">connection</span><span class="p">.</span><span class="n">BulkInsert</span><span class="p">&lt;</span><span class="n">Order</span><span class="p">&gt;(</span><span class="n">orders</span><span class="p">);</span>
        <span class="c1">// or</span>
        <span class="kt">var</span> <span class="n">result</span> <span class="p">=</span> <span class="n">connection</span><span class="p">.</span><span class="n">BulkInsert</span><span class="p">(</span><span class="s">&quot;Order&quot;</span><span class="p">,</span> <span class="n">orders</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div>
<p>Via DataReader:</p>
<div class="highlight-c# notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">sourceConnection</span> <span class="p">=</span> <span class="k">new</span> <span class="n">SqlConnection</span><span class="p">(</span><span class="s">@&quot;Server=.;Database=Northwind_Old;Integrated Security=SSPI;&quot;</span><span class="p">).</span><span class="n">EnsureOpen</span><span class="p">())</span>
<span class="p">{</span>
        <span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">reader</span> <span class="p">=</span> <span class="n">sourceConnection</span><span class="p">.</span><span class="n">ExecuteReader</span><span class="p">(</span><span class="s">&quot;SELECT Quantity, ProductId, GETUTCDATE() AS CreatedDate, GETUTCDATE() AS UpdatedDate FROM [dbo].[Order];&quot;</span><span class="p">))</span>
        <span class="p">{</span>
                <span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">destinationConnection</span> <span class="p">=</span> <span class="k">new</span> <span class="n">SqlConnection</span><span class="p">(</span><span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">).</span><span class="n">EnsureOpen</span><span class="p">())</span>
                <span class="p">{</span>
                        <span class="kt">var</span> <span class="n">result</span> <span class="p">=</span> <span class="n">destinationConnection</span><span class="p">.</span><span class="n">BulkInsert</span><span class="p">&lt;</span><span class="n">Order</span><span class="p">&gt;(</span><span class="n">reader</span><span class="p">);</span>
                        <span class="c1">// or</span>
                        <span class="kt">var</span> <span class="n">result</span> <span class="p">=</span> <span class="n">destinationConnection</span><span class="p">.</span><span class="n">BulkInsert</span><span class="p">(</span><span class="s">&quot;Order&quot;</span><span class="p">,</span> <span class="n">reader</span><span class="p">);</span>
                <span class="p">}</span>
        <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div>
<p>Via DataTable:</p>
<div class="highlight-c# notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">var</span> <span class="n">ordersTable</span> <span class="p">=</span> <span class="n">GetOrdersDataTable</span><span class="p">();</span>

<span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">connection</span> <span class="p">=</span> <span class="k">new</span> <span class="n">SqlConnection</span><span class="p">(</span><span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">).</span><span class="n">EnsureOpen</span><span class="p">())</span>
<span class="p">{</span>
        <span class="kt">var</span> <span class="n">result</span> <span class="p">=</span> <span class="n">connection</span><span class="p">.</span><span class="n">BulkInsert</span><span class="p">&lt;</span><span class="n">Order</span><span class="p">&gt;(</span><span class="n">ordersTable</span><span class="p">);</span>
        <span class="c1">// or</span>
        <span class="kt">var</span> <span class="n">result</span> <span class="p">=</span> <span class="n">connection</span><span class="p">.</span><span class="n">BulkInsert</span><span class="p">(</span><span class="s">&quot;Order&quot;</span><span class="p">,</span> <span class="n">ordersTable</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="bulkmerge">
<h2>BulkMerge<a class="headerlink" href="#bulkmerge" title="Permalink to this headline">¶</a></h2>
<p>Bulk merge a list of data entity objects into the database.</p>
<p><strong>Note:</strong> <cite>Only at package RepoDb.SqlServer.BulkOperations.</cite></p>
<p>The result would be the number of rows affected by the <cite>BulkMerge</cite> operation from the database.</p>
<p>Via DataEntities:</p>
<div class="highlight-c# notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">var</span> <span class="n">orders</span> <span class="p">=</span> <span class="k">new</span> <span class="n">List</span><span class="p">&lt;</span><span class="n">Order</span><span class="p">&gt;();</span>

<span class="n">orders</span><span class="p">.</span><span class="n">Add</span><span class="p">(</span><span class="k">new</span> <span class="n">Order</span><span class="p">()</span>
<span class="p">{</span>
        <span class="n">Id</span> <span class="p">=</span> <span class="m">1</span><span class="p">,</span>
        <span class="n">Quantity</span> <span class="p">=</span> <span class="m">2</span><span class="p">,</span>
        <span class="n">ProductId</span> <span class="p">=</span> <span class="m">12</span><span class="p">,</span>
        <span class="n">CreatedDate</span> <span class="p">=</span> <span class="n">DateTime</span><span class="p">.</span><span class="n">UtcNow</span><span class="p">,</span>
        <span class="n">UpdatedDate</span> <span class="p">=</span> <span class="n">DateTime</span><span class="p">.</span><span class="n">UtcNow</span>
<span class="p">},</span>
<span class="p">...);</span>

<span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">connection</span> <span class="p">=</span> <span class="k">new</span> <span class="n">SqlConnection</span><span class="p">(</span><span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">).</span><span class="n">EnsureOpen</span><span class="p">())</span>
<span class="p">{</span>
        <span class="kt">var</span> <span class="n">result</span> <span class="p">=</span> <span class="n">connection</span><span class="p">.</span><span class="n">BulkMerge</span><span class="p">&lt;</span><span class="n">Order</span><span class="p">&gt;(</span><span class="n">orders</span><span class="p">);</span>
        <span class="c1">// or</span>
        <span class="kt">var</span> <span class="n">result</span> <span class="p">=</span> <span class="n">connection</span><span class="p">.</span><span class="n">BulkMerge</span><span class="p">(</span><span class="s">&quot;Order&quot;</span><span class="p">,</span> <span class="n">orders</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div>
<p>Via DataReader:</p>
<div class="highlight-c# notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">sourceConnection</span> <span class="p">=</span> <span class="k">new</span> <span class="n">SqlConnection</span><span class="p">(</span><span class="s">@&quot;Server=.;Database=Northwind_Old;Integrated Security=SSPI;&quot;</span><span class="p">).</span><span class="n">EnsureOpen</span><span class="p">())</span>
<span class="p">{</span>
        <span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">reader</span> <span class="p">=</span> <span class="n">sourceConnection</span><span class="p">.</span><span class="n">ExecuteReader</span><span class="p">(</span><span class="s">&quot;SELECT Id, Quantity, ProductId, GETUTCDATE() AS CreatedDate, GETUTCDATE() AS UpdatedDate FROM [dbo].[Order];&quot;</span><span class="p">))</span>
        <span class="p">{</span>
                <span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">destinationConnection</span> <span class="p">=</span> <span class="k">new</span> <span class="n">SqlConnection</span><span class="p">(</span><span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">).</span><span class="n">EnsureOpen</span><span class="p">())</span>
                <span class="p">{</span>
                        <span class="kt">var</span> <span class="n">result</span> <span class="p">=</span> <span class="n">destinationConnection</span><span class="p">.</span><span class="n">BulkMerge</span><span class="p">&lt;</span><span class="n">Order</span><span class="p">&gt;(</span><span class="n">reader</span><span class="p">);</span>
                        <span class="c1">// or</span>
                        <span class="kt">var</span> <span class="n">result</span> <span class="p">=</span> <span class="n">destinationConnection</span><span class="p">.</span><span class="n">BulkMerge</span><span class="p">(</span><span class="s">&quot;Order&quot;</span><span class="p">,</span> <span class="n">reader</span><span class="p">);</span>
                <span class="p">}</span>
        <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div>
<p>Via DataTable:</p>
<div class="highlight-c# notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">var</span> <span class="n">ordersTable</span> <span class="p">=</span> <span class="n">GetOrdersDataTable</span><span class="p">();</span>

<span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">connection</span> <span class="p">=</span> <span class="k">new</span> <span class="n">SqlConnection</span><span class="p">(</span><span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">).</span><span class="n">EnsureOpen</span><span class="p">())</span>
<span class="p">{</span>
        <span class="kt">var</span> <span class="n">result</span> <span class="p">=</span> <span class="n">connection</span><span class="p">.</span><span class="n">BulkMerge</span><span class="p">&lt;</span><span class="n">Order</span><span class="p">&gt;(</span><span class="n">ordersTable</span><span class="p">);</span>
        <span class="c1">// or</span>
        <span class="kt">var</span> <span class="n">result</span> <span class="p">=</span> <span class="n">connection</span><span class="p">.</span><span class="n">BulkMerge</span><span class="p">(</span><span class="s">&quot;Order&quot;</span><span class="p">,</span> <span class="n">ordersTable</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="bulkupdate">
<h2>BulkUpdate<a class="headerlink" href="#bulkupdate" title="Permalink to this headline">¶</a></h2>
<p>Bulk update a list of data entity objects into the database.</p>
<p><strong>Note:</strong> <cite>Only at package RepoDb.SqlServer.BulkOperations.</cite></p>
<p>The result would be the number of rows affected by the <cite>BulkUpdate</cite> operation from the database.</p>
<p>Via DataEntities:</p>
<div class="highlight-c# notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">var</span> <span class="n">orders</span> <span class="p">=</span> <span class="k">new</span> <span class="n">List</span><span class="p">&lt;</span><span class="n">Order</span><span class="p">&gt;();</span>

<span class="n">orders</span><span class="p">.</span><span class="n">Add</span><span class="p">(</span><span class="k">new</span> <span class="n">Order</span><span class="p">()</span>
<span class="p">{</span>
        <span class="n">Id</span> <span class="p">=</span> <span class="m">1</span><span class="p">,</span>
        <span class="n">Quantity</span> <span class="p">=</span> <span class="m">2</span><span class="p">,</span>
        <span class="n">ProductId</span> <span class="p">=</span> <span class="m">12</span><span class="p">,</span>
        <span class="n">CreatedDate</span> <span class="p">=</span> <span class="n">DateTime</span><span class="p">.</span><span class="n">UtcNow</span><span class="p">,</span>
        <span class="n">UpdatedDate</span> <span class="p">=</span> <span class="n">DateTime</span><span class="p">.</span><span class="n">UtcNow</span>
<span class="p">},</span>
<span class="p">...);</span>

<span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">connection</span> <span class="p">=</span> <span class="k">new</span> <span class="n">SqlConnection</span><span class="p">(</span><span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">).</span><span class="n">EnsureOpen</span><span class="p">())</span>
<span class="p">{</span>
        <span class="kt">var</span> <span class="n">result</span> <span class="p">=</span> <span class="n">connection</span><span class="p">.</span><span class="n">BulkUpdate</span><span class="p">&lt;</span><span class="n">Order</span><span class="p">&gt;(</span><span class="n">orders</span><span class="p">);</span>
        <span class="c1">// or</span>
        <span class="kt">var</span> <span class="n">result</span> <span class="p">=</span> <span class="n">connection</span><span class="p">.</span><span class="n">BulkUpdate</span><span class="p">(</span><span class="s">&quot;Order&quot;</span><span class="p">,</span> <span class="n">orders</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div>
<p>Via DataReader:</p>
<div class="highlight-c# notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">sourceConnection</span> <span class="p">=</span> <span class="k">new</span> <span class="n">SqlConnection</span><span class="p">(</span><span class="s">@&quot;Server=.;Database=Northwind_Old;Integrated Security=SSPI;&quot;</span><span class="p">).</span><span class="n">EnsureOpen</span><span class="p">())</span>
<span class="p">{</span>
        <span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">reader</span> <span class="p">=</span> <span class="n">sourceConnection</span><span class="p">.</span><span class="n">ExecuteReader</span><span class="p">(</span><span class="s">&quot;SELECT Id, Quantity, ProductId, GETUTCDATE() AS CreatedDate, GETUTCDATE() AS UpdatedDate FROM [dbo].[Order];&quot;</span><span class="p">))</span>
        <span class="p">{</span>
                <span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">destinationConnection</span> <span class="p">=</span> <span class="k">new</span> <span class="n">SqlConnection</span><span class="p">(</span><span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">).</span><span class="n">EnsureOpen</span><span class="p">())</span>
                <span class="p">{</span>
                        <span class="kt">var</span> <span class="n">result</span> <span class="p">=</span> <span class="n">destinationConnection</span><span class="p">.</span><span class="n">BulkUpdate</span><span class="p">&lt;</span><span class="n">Order</span><span class="p">&gt;(</span><span class="n">reader</span><span class="p">);</span>
                        <span class="c1">// or</span>
                        <span class="kt">var</span> <span class="n">result</span> <span class="p">=</span> <span class="n">destinationConnection</span><span class="p">.</span><span class="n">BulkUpdate</span><span class="p">(</span><span class="s">&quot;Order&quot;</span><span class="p">,</span> <span class="n">reader</span><span class="p">);</span>
                <span class="p">}</span>
        <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div>
<p>Via DataTable:</p>
<div class="highlight-c# notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kt">var</span> <span class="n">ordersTable</span> <span class="p">=</span> <span class="n">GetOrdersDataTable</span><span class="p">();</span>

<span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">connection</span> <span class="p">=</span> <span class="k">new</span> <span class="n">SqlConnection</span><span class="p">(</span><span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">).</span><span class="n">EnsureOpen</span><span class="p">())</span>
<span class="p">{</span>
        <span class="kt">var</span> <span class="n">result</span> <span class="p">=</span> <span class="n">connection</span><span class="p">.</span><span class="n">BulkUpdate</span><span class="p">&lt;</span><span class="n">Order</span><span class="p">&gt;(</span><span class="n">ordersTable</span><span class="p">);</span>
        <span class="c1">// or</span>
        <span class="kt">var</span> <span class="n">result</span> <span class="p">=</span> <span class="n">connection</span><span class="p">.</span><span class="n">BulkUpdate</span><span class="p">(</span><span class="s">&quot;Order&quot;</span><span class="p">,</span> <span class="n">ordersTable</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div>
<p><strong>Impotant Notes:</strong></p>
<p>The arguments <cite>qualifiers</cite> and <cite>usePhysicalPseudoTempTable</cite> is given in the <cite>BulkDelete</cite>, <cite>BulkMerge</cite> and <cite>BulkUpdate</cite>.</p>
<p>The argument <cite>qualifiers</cite> is used to define the qualifier fields to be used during the operation. If it is not given, the <cite>PrimaryKey</cite> or <cite>IdentityKey</cite> columns will be used instead.</p>
<p>The argument <cite>usePhysicalPseudoTempTable</cite> is used to define whether an actual physical pseudo-table will be created during the actual operation, otherwise a temporary table will be created.</p>
</div>
<div class="section" id="count">
<h2>Count<a class="headerlink" href="#count" title="Permalink to this headline">¶</a></h2>
<p>Counts the number of table data from the database.</p>
<p>Dynamic way:</p>
<div class="highlight-c# notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">connection</span> <span class="p">=</span> <span class="k">new</span> <span class="n">SqlConnection</span><span class="p">&gt;(</span><span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">).</span><span class="n">EnsureOpen</span><span class="p">())</span>
<span class="p">{</span>
        <span class="kt">var</span> <span class="n">result</span> <span class="p">=</span> <span class="n">connection</span><span class="p">.</span><span class="n">Count</span><span class="p">&lt;</span><span class="n">Order</span><span class="p">&gt;(</span><span class="k">new</span> <span class="p">{</span> <span class="n">CustomerId</span> <span class="p">=</span> <span class="m">10045</span> <span class="p">});</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div>
<p>Expression way:</p>
<div class="highlight-c# notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">connection</span> <span class="p">=</span> <span class="k">new</span> <span class="n">SqlConnection</span><span class="p">&gt;(</span><span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">).</span><span class="n">EnsureOpen</span><span class="p">())</span>
<span class="p">{</span>
        <span class="kt">var</span> <span class="n">result</span> <span class="p">=</span> <span class="n">connection</span><span class="p">.</span><span class="n">Count</span><span class="p">&lt;</span><span class="n">Order</span><span class="p">&gt;(</span><span class="n">o</span> <span class="p">=&gt;</span> <span class="n">o</span><span class="p">.</span><span class="n">CustomerId</span> <span class="p">==</span> <span class="m">10045</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div>
<p>Explicit way:</p>
<div class="highlight-c# notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">connection</span> <span class="p">=</span> <span class="k">new</span> <span class="n">SqlConnection</span><span class="p">&gt;(</span><span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">).</span><span class="n">EnsureOpen</span><span class="p">())</span>
<span class="p">{</span>
        <span class="kt">var</span> <span class="n">result</span> <span class="p">=</span> <span class="n">connection</span><span class="p">.</span><span class="n">Count</span><span class="p">&lt;</span><span class="n">Order</span><span class="p">&gt;(</span><span class="k">new</span> <span class="n">QueryField</span><span class="p">(</span><span class="n">nameof</span><span class="p">(</span><span class="n">Order</span><span class="p">.</span><span class="n">CustomerId</span><span class="p">),</span> <span class="m">10045</span><span class="p">));</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div>
<p>Records can all also be counted via table name.</p>
<p>Dynamic way:</p>
<div class="highlight-c# notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">connection</span> <span class="p">=</span> <span class="k">new</span> <span class="n">SqlConnection</span><span class="p">&gt;(</span><span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">).</span><span class="n">EnsureOpen</span><span class="p">())</span>
<span class="p">{</span>
        <span class="kt">var</span> <span class="n">result</span> <span class="p">=</span> <span class="n">connection</span><span class="p">.</span><span class="n">Count</span><span class="p">(</span><span class="s">&quot;Order&quot;</span><span class="p">,</span> <span class="k">new</span> <span class="p">{</span> <span class="n">CustomerId</span> <span class="p">=</span> <span class="m">10045</span> <span class="p">});</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div>
<p>Explicit way:</p>
<div class="highlight-c# notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">connection</span> <span class="p">=</span> <span class="k">new</span> <span class="n">SqlConnection</span><span class="p">&gt;(</span><span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">).</span><span class="n">EnsureOpen</span><span class="p">())</span>
<span class="p">{</span>
        <span class="kt">var</span> <span class="n">result</span> <span class="p">=</span> <span class="n">connection</span><span class="p">.</span><span class="n">Count</span><span class="p">(</span><span class="s">&quot;Order&quot;</span><span class="p">,</span> <span class="k">new</span> <span class="n">QueryField</span><span class="p">(</span><span class="n">nameof</span><span class="p">(</span><span class="n">Order</span><span class="p">.</span><span class="n">CustomerId</span><span class="p">),</span> <span class="m">10045</span><span class="p">));</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div>
<p><strong>Note</strong>: By setting the <cite>where</cite> argument to blank would count all the records. Exactly the same as <cite>CountAll</cite> operation.</p>
</div>
<div class="section" id="countall">
<h2>CountAll<a class="headerlink" href="#countall" title="Permalink to this headline">¶</a></h2>
<p>Counts all the table data from the database.</p>
<div class="highlight-c# notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">connection</span> <span class="p">=</span> <span class="k">new</span> <span class="n">SqlConnection</span><span class="p">&gt;(</span><span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">).</span><span class="n">EnsureOpen</span><span class="p">())</span>
<span class="p">{</span>
        <span class="kt">var</span> <span class="n">result</span> <span class="p">=</span> <span class="n">connection</span><span class="p">.</span><span class="n">CountAll</span><span class="p">&lt;</span><span class="n">Order</span><span class="p">&gt;();</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div>
<p>All records can all also be counted via table name.</p>
<p>Dynamic way:</p>
<div class="highlight-c# notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">connection</span> <span class="p">=</span> <span class="k">new</span> <span class="n">SqlConnection</span><span class="p">&gt;(</span><span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">).</span><span class="n">EnsureOpen</span><span class="p">())</span>
<span class="p">{</span>
        <span class="kt">var</span> <span class="n">result</span> <span class="p">=</span> <span class="n">connection</span><span class="p">.</span><span class="n">CountAll</span><span class="p">(</span><span class="s">&quot;Order&quot;</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="createcommand">
<h2>CreateCommand<a class="headerlink" href="#createcommand" title="Permalink to this headline">¶</a></h2>
<p>Creates a command object.</p>
<div class="highlight-c# notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1">// Variables</span>
<span class="kt">var</span> <span class="n">customers</span> <span class="p">=</span> <span class="p">(</span><span class="n">IEnumerable</span><span class="p">&lt;</span><span class="n">Customer</span><span class="p">&gt;)</span><span class="k">null</span><span class="p">;</span>

<span class="c1">// Open a connection</span>
<span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">connection</span> <span class="p">=</span> <span class="k">new</span> <span class="n">SqlConnection</span><span class="p">(</span><span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">).</span><span class="n">EnsureOpen</span><span class="p">())</span>
<span class="p">{</span>
        <span class="c1">// Create a command object</span>
        <span class="kt">var</span> <span class="n">command</span> <span class="p">=</span> <span class="n">connection</span><span class="p">.</span><span class="n">CreateCommand</span><span class="p">(</span><span class="s">&quot;SELECT TOP 100 * FROM [dbo].[Customer];&quot;</span><span class="p">,</span> <span class="n">CommandType</span><span class="p">.</span><span class="n">Text</span><span class="p">,</span> <span class="m">500</span><span class="p">,</span> <span class="k">null</span><span class="p">);</span>

        <span class="c1">// Use the command object here</span>
        <span class="p">...</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="delete">
<h2>Delete<a class="headerlink" href="#delete" title="Permalink to this headline">¶</a></h2>
<p>Deletes an existing data from the database.</p>
<p>Via DataEntity:</p>
<div class="highlight-c# notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">connection</span> <span class="p">=</span> <span class="k">new</span> <span class="n">SqlConnection</span><span class="p">(</span><span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">).</span><span class="n">EnsureOpen</span><span class="p">())</span>
<span class="p">{</span>
        <span class="kt">var</span> <span class="n">customer</span> <span class="p">=</span> <span class="n">connection</span><span class="p">.</span><span class="n">Query</span><span class="p">&lt;</span><span class="n">Customer</span><span class="p">&gt;(</span><span class="m">10045</span><span class="p">);</span>
        <span class="p">...</span>
        <span class="kt">var</span> <span class="n">result</span> <span class="p">=</span> <span class="n">connection</span><span class="p">.</span><span class="n">Delete</span><span class="p">(</span><span class="n">customer</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div>
<p>Via PrimaryKey:</p>
<div class="highlight-c# notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">connection</span> <span class="p">=</span> <span class="k">new</span> <span class="n">SqlConnection</span><span class="p">(</span><span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">).</span><span class="n">EnsureOpen</span><span class="p">())</span>
<span class="p">{</span>
        <span class="kt">var</span> <span class="n">result</span> <span class="p">=</span> <span class="n">connection</span><span class="p">.</span><span class="n">Delete</span><span class="p">&lt;</span><span class="n">Customer</span><span class="p">&gt;(</span><span class="m">10045</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div>
<p><strong>Note</strong>: The library uses the <cite>PrimaryKey</cite> as the default qualifier for <cite>Delete</cite> operation. This also applies when deleting the <cite>data entity</cite> object itself. This call will throw an exception if the data entity does not have a primary key.</p>
<p>Via Dynamic:</p>
<div class="highlight-c# notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">connection</span> <span class="p">=</span> <span class="k">new</span> <span class="n">SqlConnection</span><span class="p">(</span><span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">).</span><span class="n">EnsureOpen</span><span class="p">())</span>
<span class="p">{</span>
        <span class="kt">var</span> <span class="n">result</span> <span class="p">=</span> <span class="n">connection</span><span class="p">.</span><span class="n">Delete</span><span class="p">&lt;</span><span class="n">Customer</span><span class="p">&gt;(</span><span class="k">new</span> <span class="p">{</span> <span class="n">Id</span> <span class="p">=</span> <span class="m">10045</span> <span class="p">});</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div>
<p>Expression way:</p>
<div class="highlight-c# notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">connection</span> <span class="p">=</span> <span class="k">new</span> <span class="n">SqlConnection</span><span class="p">(</span><span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">).</span><span class="n">EnsureOpen</span><span class="p">())</span>
<span class="p">{</span>
        <span class="kt">var</span> <span class="n">result</span> <span class="p">=</span> <span class="n">connection</span><span class="p">.</span><span class="n">Delete</span><span class="p">&lt;</span><span class="n">Customer</span><span class="p">&gt;(</span><span class="n">c</span> <span class="p">=&gt;</span> <span class="n">c</span><span class="p">.</span><span class="n">Id</span> <span class="p">==</span> <span class="m">10045</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div>
<p>Explicit way:</p>
<div class="highlight-c# notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">connection</span> <span class="p">=</span> <span class="k">new</span> <span class="n">SqlConnection</span><span class="p">(</span><span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">).</span><span class="n">EnsureOpen</span><span class="p">())</span>
<span class="p">{</span>
        <span class="kt">var</span> <span class="n">result</span> <span class="p">=</span> <span class="n">connection</span><span class="p">.</span><span class="n">Delete</span><span class="p">&lt;</span><span class="n">Customer</span><span class="p">&gt;(</span><span class="k">new</span> <span class="n">QueryField</span><span class="p">(</span><span class="n">nameof</span><span class="p">(</span><span class="n">Order</span><span class="p">.</span><span class="n">CustomerId</span><span class="p">),</span> <span class="m">10045</span><span class="p">));</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div>
<p>Records can also be deleted via table name.</p>
<p>Via Dynamic:</p>
<div class="highlight-c# notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">connection</span> <span class="p">=</span> <span class="k">new</span> <span class="n">SqlConnection</span><span class="p">(</span><span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">).</span><span class="n">EnsureOpen</span><span class="p">())</span>
<span class="p">{</span>
        <span class="kt">var</span> <span class="n">result</span> <span class="p">=</span> <span class="n">connection</span><span class="p">.</span><span class="n">Delete</span><span class="p">(</span><span class="s">&quot;Customer&quot;</span><span class="p">,</span> <span class="k">new</span> <span class="p">{</span> <span class="n">Id</span> <span class="p">=</span> <span class="m">10045</span> <span class="p">});</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div>
<p>Explicit way:</p>
<div class="highlight-c# notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">connection</span> <span class="p">=</span> <span class="k">new</span> <span class="n">SqlConnection</span><span class="p">(</span><span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">).</span><span class="n">EnsureOpen</span><span class="p">())</span>
<span class="p">{</span>
        <span class="kt">var</span> <span class="n">result</span> <span class="p">=</span> <span class="n">connection</span><span class="p">.</span><span class="n">Delete</span><span class="p">(</span><span class="s">&quot;Customer&quot;</span><span class="p">,</span> <span class="k">new</span> <span class="n">QueryField</span><span class="p">(</span><span class="n">nameof</span><span class="p">(</span><span class="n">Order</span><span class="p">.</span><span class="n">CustomerId</span><span class="p">),</span> <span class="m">10045</span><span class="p">));</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div>
<p><strong>Note</strong>: By setting the <cite>where</cite> argument to blank would delete all the records. Exactly the same as <cite>DeleteAll</cite> operation.</p>
</div>
<div class="section" id="deleteall">
<h2>DeleteAll<a class="headerlink" href="#deleteall" title="Permalink to this headline">¶</a></h2>
<p>Deletes all the data from the database.</p>
<div class="highlight-c# notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">connection</span> <span class="p">=</span> <span class="k">new</span> <span class="n">SqlConnection</span><span class="p">(</span><span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">).</span><span class="n">EnsureOpen</span><span class="p">())</span>
<span class="p">{</span>
        <span class="kt">var</span> <span class="n">customer</span> <span class="p">=</span> <span class="n">connection</span><span class="p">.</span><span class="n">DeleteAll</span><span class="p">&lt;</span><span class="n">Customer</span><span class="p">&gt;();</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div>
<p>All records can also be deleted via table name.</p>
<div class="highlight-c# notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">connection</span> <span class="p">=</span> <span class="k">new</span> <span class="n">SqlConnection</span><span class="p">(</span><span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">).</span><span class="n">EnsureOpen</span><span class="p">())</span>
<span class="p">{</span>
        <span class="kt">var</span> <span class="n">result</span> <span class="p">=</span> <span class="n">connection</span><span class="p">.</span><span class="n">DeleteAll</span><span class="p">(</span><span class="s">&quot;Customer&quot;</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="ensureopen">
<h2>EnsureOpen<a class="headerlink" href="#ensureopen" title="Permalink to this headline">¶</a></h2>
<p>Ensures the connection object is open.</p>
<div class="highlight-c# notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">connection</span> <span class="p">=</span> <span class="k">new</span> <span class="n">SqlConnection</span><span class="p">(</span><span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">).</span><span class="n">EnsureOpen</span><span class="p">())</span>
<span class="p">{</span>
        <span class="c1">// Use the connection here</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="executenonquery">
<h2>ExecuteNonQuery<a class="headerlink" href="#executenonquery" title="Permalink to this headline">¶</a></h2>
<p>Executes a query from the database. It uses the underlying method <cite>IDbCommand.ExecuteNonQuery</cite> and returns the number of affected rows during the execution.</p>
<div class="highlight-c# notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">connection</span> <span class="p">=</span> <span class="k">new</span> <span class="n">SqlConnection</span><span class="p">(</span><span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">).</span><span class="n">EnsureOpen</span><span class="p">())</span>
<span class="p">{</span>
        <span class="kt">var</span> <span class="n">commandText</span> <span class="p">=</span> <span class="s">@&quot;UPDATE O</span>
<span class="s">                SET O.Quantity = @Quantity</span>
<span class="s">                        , O.LastUpdatedUtc = @LastUpdatedUtc</span>
<span class="s">                FROM [dbo].[Order] O</span>
<span class="s">                WHERE (O.Id = @OrderId);&quot;</span><span class="p">;</span>

        <span class="c1">// Set the parameters</span>
        <span class="kt">var</span> <span class="n">parameters</span> <span class="p">=</span> <span class="k">new</span>
        <span class="p">{</span>
                <span class="n">OrderId</span> <span class="p">=</span> <span class="m">1002</span><span class="p">,</span>
                <span class="n">Quantity</span> <span class="p">=</span> <span class="m">5</span><span class="p">,</span>
                <span class="n">LastUpdatedUtc</span> <span class="p">=</span> <span class="n">DateTime</span><span class="p">.</span><span class="n">UtcNow</span>
        <span class="p">};</span>

        <span class="c1">// Execute the command text</span>
        <span class="kt">var</span> <span class="n">result</span> <span class="p">=</span> <span class="n">connection</span><span class="p">.</span><span class="n">ExecuteNonQuery</span><span class="p">(</span><span class="n">commandText</span><span class="p">,</span> <span class="n">parameters</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div>
<p>Let us say the stored procedure below exists.</p>
<div class="highlight-sql notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">DROP</span> <span class="k">PROCEDURE</span> <span class="k">IF</span> <span class="k">EXISTS</span> <span class="p">[</span><span class="n">dbo</span><span class="p">].[</span><span class="n">sp_update_order_quantity</span><span class="p">];</span>
<span class="k">GO</span>

<span class="k">CREATE</span> <span class="k">PROCEDURE</span> <span class="p">[</span><span class="n">dbo</span><span class="p">].[</span><span class="n">sp_update_order_quantity</span><span class="p">]</span>
<span class="p">(</span>
        <span class="o">@</span><span class="n">OrderId</span> <span class="nb">INT</span>
        <span class="p">,</span> <span class="o">@</span><span class="n">Quantity</span> <span class="nb">INT</span>
<span class="p">)</span>
<span class="k">AS</span>
<span class="k">BEGIN</span>
        <span class="k">UPDATE</span> <span class="n">O</span>
        <span class="k">SET</span> <span class="n">O</span><span class="p">.</span><span class="n">Quantity</span> <span class="o">=</span> <span class="o">@</span><span class="n">Quantity</span>
                <span class="p">,</span> <span class="n">O</span><span class="p">.</span><span class="n">LastUpdatedUtc</span> <span class="o">=</span> <span class="n">GETUTCDATE</span><span class="p">()</span>
        <span class="k">FROM</span> <span class="p">[</span><span class="n">dbo</span><span class="p">].[</span><span class="k">Order</span><span class="p">]</span> <span class="n">O</span>
        <span class="k">WHERE</span> <span class="p">(</span><span class="n">O</span><span class="p">.</span><span class="n">Id</span> <span class="o">=</span> <span class="o">@</span><span class="n">OrderId</span><span class="p">);</span>
<span class="k">END</span>
</pre></div>
</td></tr></table></div>
<p>Below is the code on how to execute a stored procedure mentioned above:</p>
<div class="highlight-c# notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">connection</span> <span class="p">=</span> <span class="k">new</span> <span class="n">SqlConnection</span><span class="p">(</span><span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">).</span><span class="n">EnsureOpen</span><span class="p">())</span>
<span class="p">{</span>
        <span class="c1">// Set the parameters</span>
        <span class="kt">var</span> <span class="n">parameters</span> <span class="p">=</span> <span class="k">new</span>
        <span class="p">{</span>
                <span class="n">OrderId</span> <span class="p">=</span> <span class="m">1002</span><span class="p">,</span>
                <span class="n">Quantity</span> <span class="p">=</span> <span class="m">5</span><span class="p">,</span>
                <span class="n">LastUpdatedUtc</span> <span class="p">=</span> <span class="n">DateTime</span><span class="p">.</span><span class="n">UtcNow</span>
        <span class="p">};</span>

        <span class="c1">// Call the procedure</span>
        <span class="kt">var</span> <span class="n">result</span> <span class="p">=</span> <span class="n">connection</span><span class="p">.</span><span class="n">ExecuteNonQuery</span><span class="p">(</span><span class="s">&quot;[dbo].[sp_update_order_quantity]&quot;</span><span class="p">,</span> <span class="n">parameters</span><span class="p">,</span> <span class="n">commandType</span><span class="p">:</span> <span class="n">CommandType</span><span class="p">.</span><span class="n">StoredProcedure</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="executequery">
<h2>ExecuteQuery<a class="headerlink" href="#executequery" title="Permalink to this headline">¶</a></h2>
<p>Executes a query from the database. It uses the underlying method <cite>IDbCommand.ExecuteReader</cite> and converts the result back to an enumerable list of dynamic objects.</p>
<div class="highlight-c# notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">connection</span> <span class="p">=</span> <span class="k">new</span> <span class="n">SqlConnection</span><span class="p">(</span><span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">).</span><span class="n">EnsureOpen</span><span class="p">())</span>
<span class="p">{</span>
        <span class="kt">var</span> <span class="n">commandText</span> <span class="p">=</span> <span class="s">@&quot;SELECT * FROM [dbo].[Customer] WHERE CustomerId = @CustomerId;&quot;</span><span class="p">;</span>
        <span class="kt">var</span> <span class="n">result</span> <span class="p">=</span> <span class="n">connection</span><span class="p">.</span><span class="n">ExecuteQuery</span><span class="p">&lt;</span><span class="n">Order</span><span class="p">&gt;(</span><span class="n">commandText</span><span class="p">,</span> <span class="k">new</span> <span class="p">{</span> <span class="n">CustomerId</span> <span class="p">=</span> <span class="m">10045</span> <span class="p">});</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div>
<p>Let us say the stored procedure below exists.</p>
<div class="highlight-sql notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">DROP</span> <span class="k">PROCEDURE</span> <span class="k">IF</span> <span class="k">EXISTS</span> <span class="p">[</span><span class="n">dbo</span><span class="p">].[</span><span class="n">sp_get_customer</span><span class="p">];</span>
<span class="k">GO</span>

<span class="k">CREATE</span> <span class="k">PROCEDURE</span> <span class="p">[</span><span class="n">dbo</span><span class="p">].[</span><span class="n">sp_get_customer</span><span class="p">]</span>
<span class="p">(</span>
        <span class="o">@</span><span class="n">CustomerId</span> <span class="nb">INT</span>
<span class="p">)</span>
<span class="k">AS</span>
<span class="k">BEGIN</span>
        <span class="k">SELECT</span> <span class="o">*</span>
        <span class="k">FROM</span> <span class="p">[</span><span class="n">dbo</span><span class="p">].[</span><span class="n">Customer</span><span class="p">]</span> <span class="k">C</span>
        <span class="k">WHERE</span> <span class="p">(</span><span class="k">C</span><span class="p">.</span><span class="n">Id</span> <span class="o">=</span> <span class="o">@</span><span class="n">CustomerId</span><span class="p">);</span>
<span class="k">END</span>
</pre></div>
</td></tr></table></div>
<p>Below is the code on how to execute a stored procedure mentioned above:</p>
<div class="highlight-c# notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">connection</span> <span class="p">=</span> <span class="k">new</span> <span class="n">SqlConnection</span><span class="p">(</span><span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">).</span><span class="n">EnsureOpen</span><span class="p">())</span>
<span class="p">{</span>
        <span class="kt">var</span> <span class="n">result</span> <span class="p">=</span> <span class="n">connection</span><span class="p">.</span><span class="n">ExecuteNonQuery</span><span class="p">(</span><span class="s">&quot;[dbo].[sp_get_customer]&quot;</span><span class="p">,</span>
                <span class="k">new</span> <span class="p">{</span> <span class="n">CustomerId</span> <span class="p">=</span> <span class="m">10045</span> <span class="p">},</span>
                <span class="n">commandType</span><span class="p">:</span> <span class="n">CommandType</span><span class="p">.</span><span class="n">StoredProcedure</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div>
<p>An <cite>ExecuteQuery</cite> method can directly return an enumerable list of data entity object. No need to use the <cite>ExecuteReader</cite> method.</p>
<div class="highlight-c# notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">connection</span> <span class="p">=</span> <span class="k">new</span> <span class="n">SqlConnection</span><span class="p">&gt;(</span><span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">).</span><span class="n">EnsureOpen</span><span class="p">())</span>
<span class="p">{</span>
        <span class="kt">var</span> <span class="n">orders</span> <span class="p">=</span> <span class="n">connection</span><span class="p">.</span><span class="n">ExecuteQuery</span><span class="p">&lt;</span><span class="n">Order</span><span class="p">&gt;(</span><span class="s">&quot;SELECT * FROM [dbo].[Order] WHERE CustomerId = @CustomerId;&quot;</span><span class="p">,</span> <span class="k">new</span> <span class="p">{</span> <span class="n">CustomerId</span> <span class="p">=</span> <span class="m">10045</span> <span class="p">});</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div>
<p>The class property accessibility is very dynamic through this method. Let us say the order table schema is below.</p>
<div class="highlight-sql notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">DROP</span> <span class="k">TABLE</span> <span class="k">IF</span> <span class="k">EXISTS</span> <span class="p">[</span><span class="n">dbo</span><span class="p">].[</span><span class="k">Order</span><span class="p">];</span>
<span class="k">GO</span>
<span class="k">CREATE</span> <span class="k">TABLE</span> <span class="p">[</span><span class="n">dbo</span><span class="p">].[</span><span class="k">Order</span><span class="p">]</span>
<span class="p">(</span>
        <span class="n">Id</span> <span class="nb">INT</span>
        <span class="p">,</span> <span class="n">CustomerId</span> <span class="nb">INT</span>
        <span class="p">,</span> <span class="n">OrderDate</span> <span class="n">DATETIME2</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
        <span class="p">,</span> <span class="n">Quantity</span> <span class="nb">INT</span>
        <span class="p">,</span> <span class="n">CreatedDate</span> <span class="n">DATETIME2</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
        <span class="p">,</span> <span class="n">UpdatedDate</span> <span class="n">DATETIME2</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
<span class="p">);</span>
<span class="k">GO</span>
</pre></div>
</td></tr></table></div>
<p>No need for the class to have the exact match of the properties (also applicable in all fetch operations like <cite>BatchQuery</cite>, <cite>ExecuteQueryMultiple</cite>, <cite>Query</cite> and <cite>QueryMultiple</cite> operations).</p>
<div class="highlight-c# notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">public</span> <span class="k">class</span> <span class="nc">ComplexOrder</span>
<span class="p">{</span>
        <span class="c1">// Match properties</span>
        <span class="k">public</span> <span class="kt">int</span> <span class="n">Id</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span>
        <span class="k">public</span> <span class="kt">int</span> <span class="n">CustomerId</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span>
        <span class="k">public</span> <span class="kt">int</span> <span class="n">Quantity</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span>
        <span class="k">public</span> <span class="n">DateTime</span> <span class="n">OrderDate</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span>

        <span class="c1">// Unmatch properties</span>
        <span class="k">public</span> <span class="kt">int</span> <span class="n">ProductId</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span>
        <span class="k">public</span> <span class="kt">int</span> <span class="n">OrderItemId</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span>
        <span class="k">public</span> <span class="kt">int</span> <span class="n">Price</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span>
        <span class="k">public</span> <span class="kt">double</span> <span class="n">Total</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span>

        <span class="c1">// Note: The CreatedDate and UpdatedDate is not defined on this class</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div>
<p>Then call the records with the code below.</p>
<div class="highlight-c# notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">connection</span> <span class="p">=</span> <span class="k">new</span> <span class="n">SqlConnection</span><span class="p">&gt;(</span><span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">).</span><span class="n">EnsureOpen</span><span class="p">())</span>
<span class="p">{</span>
        <span class="kt">var</span> <span class="n">orders</span> <span class="p">=</span> <span class="n">connection</span><span class="p">.</span><span class="n">ExecuteQuery</span><span class="p">&lt;</span><span class="n">ComplexOrder</span><span class="p">&gt;(</span><span class="s">&quot;SELECT * FROM [dbo].[Order] WHERE CustomerId = @CustomerId;&quot;</span><span class="p">,</span> <span class="k">new</span> <span class="p">{</span> <span class="n">CustomerId</span> <span class="p">=</span> <span class="m">10045</span> <span class="p">});</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div>
<p>Or, if a complex stored procedure is present.</p>
<div class="highlight-c# notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">connection</span> <span class="p">=</span> <span class="k">new</span> <span class="n">SqlConnection</span><span class="p">&gt;(</span><span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">).</span><span class="n">EnsureOpen</span><span class="p">())</span>
<span class="p">{</span>
        <span class="kt">var</span> <span class="n">orders</span> <span class="p">=</span> <span class="n">connection</span><span class="p">.</span><span class="n">ExecuteQuery</span><span class="p">&lt;</span><span class="n">ComplexOrder</span><span class="p">&gt;(</span><span class="s">&quot;[dbo].[sp_name]&quot;</span><span class="p">,</span> <span class="k">new</span> <span class="p">{</span> <span class="n">CustomerId</span> <span class="p">=</span> <span class="m">10045</span> <span class="p">},</span> <span class="n">commandType</span><span class="p">:</span> <span class="n">CommandType</span><span class="p">.</span><span class="n">StoredProcedure</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div>
<p>The <cite>ExecuteQuery</cite> method can also return a list of dynamic objects.</p>
<div class="highlight-c# notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">connection</span> <span class="p">=</span> <span class="k">new</span> <span class="n">SqlConnection</span><span class="p">&gt;(</span><span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">).</span><span class="n">EnsureOpen</span><span class="p">())</span>
<span class="p">{</span>
        <span class="c1">// Did not passed the &lt;TEntity&gt;</span>
        <span class="kt">var</span> <span class="n">orders</span> <span class="p">=</span> <span class="n">connection</span><span class="p">.</span><span class="n">ExecuteQuery</span><span class="p">(</span><span class="s">&quot;SELECT * FROM [dbo].[Order] WHERE CustomerId = @CustomerId;&quot;</span><span class="p">,</span> <span class="k">new</span> <span class="p">{</span> <span class="n">CustomerId</span> <span class="p">=</span> <span class="m">10045</span> <span class="p">});</span>

        <span class="c1">// Iterate the orders</span>
        <span class="k">foreach</span> <span class="p">(</span><span class="kt">var</span> <span class="n">order</span> <span class="k">in</span> <span class="n">orders</span><span class="p">)</span>
        <span class="p">{</span>
                <span class="c1">// The &#39;order&#39; is dynamic</span>
        <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div>
<div class="highlight-c# notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">connection</span> <span class="p">=</span> <span class="k">new</span> <span class="n">SqlConnection</span><span class="p">&gt;(</span><span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">).</span><span class="n">EnsureOpen</span><span class="p">())</span>
<span class="p">{</span>
        <span class="c1">// Did not passed the &lt;TEntity&gt;</span>
        <span class="kt">var</span> <span class="n">orders</span> <span class="p">=</span> <span class="n">connection</span><span class="p">.</span><span class="n">ExecuteQuery</span><span class="p">(</span><span class="s">&quot;[dbo].[sp_name]&quot;</span><span class="p">,</span> <span class="k">new</span> <span class="p">{</span> <span class="n">CustomerId</span> <span class="p">=</span> <span class="m">10045</span> <span class="p">},</span> <span class="n">commandType</span><span class="p">:</span> <span class="n">CommandType</span><span class="p">.</span><span class="n">StoredProcedure</span><span class="p">);</span>

        <span class="c1">// Iterate the orders</span>
        <span class="k">foreach</span> <span class="p">(</span><span class="kt">var</span> <span class="n">order</span> <span class="k">in</span> <span class="n">orders</span><span class="p">)</span>
        <span class="p">{</span>
                <span class="c1">// The &#39;order&#39; is dynamic</span>
        <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div>
<p><strong>Note</strong>: Calling the <cite>ExecuteQuery</cite> via dynamic is a bit slower compared to a .NET CLR Type-based calls.</p>
</div>
<div class="section" id="executequerymultiple">
<h2>ExecuteQueryMultiple<a class="headerlink" href="#executequerymultiple" title="Permalink to this headline">¶</a></h2>
<p>Executes a multiple query statement from the database and allows the user to extract the result to a target data entity.</p>
<div class="highlight-c# notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">connection</span> <span class="p">=</span> <span class="k">new</span> <span class="n">SqlConnection</span><span class="p">(</span><span class="s">&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">).</span><span class="n">EnsureOpen</span><span class="p">())</span>
<span class="p">{</span>
        <span class="kt">var</span> <span class="n">commandText</span> <span class="p">=</span> <span class="s">@&quot;SELECT * FROM Customer WHERE Id = @CustomerId;</span>
<span class="s">                SELECT * FROM [Order] WHERE CustomerId = @CustomerId;&quot;</span><span class="p">;</span>

        <span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">result</span> <span class="p">=</span> <span class="n">connection</span><span class="p">.</span><span class="n">ExecuteQueryMultiple</span><span class="p">(</span><span class="n">commandText</span><span class="p">,</span> <span class="k">new</span> <span class="p">{</span> <span class="n">CustomerId</span> <span class="p">=</span> <span class="m">10045</span> <span class="p">}))</span>
        <span class="p">{</span>
                <span class="c1">// Extract the first result</span>
                <span class="kt">var</span> <span class="n">customers</span> <span class="p">=</span> <span class="n">result</span><span class="p">.</span><span class="n">Extract</span><span class="p">&lt;</span><span class="n">Customer</span><span class="p">&gt;();</span>

                <span class="c1">// Extract the second result</span>
                <span class="kt">var</span> <span class="n">orders</span> <span class="p">=</span> <span class="n">result</span><span class="p">.</span><span class="n">Extract</span><span class="p">&lt;</span><span class="n">Order</span><span class="p">&gt;();</span>
        <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div>
<p>The method <cite>Scalar</cite> is used to extract the value of the first column of the first row of the <cite>DbDataReader</cite> object.</p>
<div class="highlight-c# notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">connection</span> <span class="p">=</span> <span class="k">new</span> <span class="n">SqlConnection</span><span class="p">(</span><span class="s">&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">).</span><span class="n">EnsureOpen</span><span class="p">())</span>
<span class="p">{</span>
        <span class="kt">var</span> <span class="n">commandText</span> <span class="p">=</span> <span class="s">@&quot;SELECT * FROM Customer WHERE Id = @CustomerId;</span>
<span class="s">                SELECT COUNT(*) FROM [Order] WHERE CustomerId = @CustomerId;&quot;</span><span class="p">;</span>

        <span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">result</span> <span class="p">=</span> <span class="n">connection</span><span class="p">.</span><span class="n">ExecuteQueryMultiple</span><span class="p">(</span><span class="n">commandText</span><span class="p">,</span> <span class="k">new</span> <span class="p">{</span> <span class="n">CustomerId</span> <span class="p">=</span> <span class="m">10045</span> <span class="p">}))</span>
        <span class="p">{</span>
                <span class="c1">// Extract the first result</span>
                <span class="kt">var</span> <span class="n">customers</span> <span class="p">=</span> <span class="n">result</span><span class="p">.</span><span class="n">Extract</span><span class="p">&lt;</span><span class="n">Customer</span><span class="p">&gt;();</span>

                <span class="c1">// Extract the second result</span>
                <span class="kt">var</span> <span class="n">ordersCount</span> <span class="p">=</span> <span class="p">(</span><span class="kt">int</span><span class="p">)</span><span class="n">result</span><span class="p">.</span><span class="n">Scalar</span><span class="p">();</span>
        <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div>
<p>This method can also be used to combine the calls with Stored Procedure.</p>
<div class="highlight-sql notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">CREATE</span> <span class="k">PROCEDURE</span> <span class="p">[</span><span class="n">dbo</span><span class="p">].[</span><span class="n">sp_get_customer_orders</span><span class="p">]</span>
<span class="p">(</span>
        <span class="o">@</span><span class="n">CustomerId</span> <span class="nb">INT</span>
<span class="p">)</span>
<span class="k">AS</span>
<span class="k">BEGIN</span>
        <span class="k">SELECT</span> <span class="o">*</span>
        <span class="k">FROM</span> <span class="p">[</span><span class="n">dbo</span><span class="p">].[</span><span class="k">Order</span><span class="p">]</span>
        <span class="k">WHERE</span> <span class="p">(</span><span class="n">CustomerId</span> <span class="o">=</span> <span class="o">@</span><span class="n">CustomerId</span><span class="p">);</span>
<span class="k">END</span>
</pre></div>
</td></tr></table></div>
<div class="highlight-c# notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">connection</span> <span class="p">=</span> <span class="k">new</span> <span class="n">SqlConnection</span><span class="p">(</span><span class="s">&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">).</span><span class="n">EnsureOpen</span><span class="p">())</span>
<span class="p">{</span>
        <span class="kt">var</span> <span class="n">commandText</span> <span class="p">=</span> <span class="s">@&quot;SELECT * FROM Customer WHERE Id = @CustomerId;</span>
<span class="s">                EXEC [dbo].[sp_get_customer_orders] @CustomerId;&quot;</span><span class="p">;</span>
        <span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">result</span> <span class="p">=</span> <span class="n">connection</span><span class="p">.</span><span class="n">ExecuteQueryMultiple</span><span class="p">(</span><span class="n">commandText</span><span class="p">,</span> <span class="k">new</span> <span class="p">{</span> <span class="n">CustomerId</span> <span class="p">=</span> <span class="m">10045</span> <span class="p">}))</span>
        <span class="p">{</span>
                <span class="c1">// Extract the first result</span>
                <span class="kt">var</span> <span class="n">customers</span> <span class="p">=</span> <span class="n">result</span><span class="p">.</span><span class="n">Extract</span><span class="p">&lt;</span><span class="n">Customer</span><span class="p">&gt;();</span>

                <span class="c1">// Extract the second result</span>
                <span class="kt">var</span> <span class="n">orders</span> <span class="p">=</span> <span class="n">result</span><span class="p">.</span><span class="n">Extract</span><span class="p">&lt;</span><span class="n">Order</span><span class="p">&gt;();</span>
        <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="executereader">
<h2>ExecuteReader<a class="headerlink" href="#executereader" title="Permalink to this headline">¶</a></h2>
<p>Executes a query from the database. It uses the underlying method <cite>IDbCommand.ExecuteReader</cite> and returns the instance of the data reader.</p>
<div class="highlight-c# notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">connection</span> <span class="p">=</span> <span class="k">new</span> <span class="n">SqlConnection</span><span class="p">(</span><span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">).</span><span class="n">EnsureOpen</span><span class="p">())</span>
<span class="p">{</span>
        <span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">reader</span> <span class="p">=</span> <span class="n">connection</span><span class="p">.</span><span class="n">ExecuteReader</span><span class="p">(</span><span class="s">&quot;SELECT * FROM [dbo].[Customer] WHERE CustomerId = @CustomerId;&quot;</span><span class="p">,</span> <span class="k">new</span> <span class="p">{</span> <span class="n">CustomerId</span> <span class="p">=</span> <span class="m">10045</span> <span class="p">}))</span>
        <span class="p">{</span>
                <span class="c1">// Use the data reader here</span>
        <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div>
<p>Let us say the stored procedure below exists.</p>
<div class="highlight-sql notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">DROP</span> <span class="k">PROCEDURE</span> <span class="k">IF</span> <span class="k">EXISTS</span> <span class="p">[</span><span class="n">dbo</span><span class="p">].[</span><span class="n">sp_get_customer</span><span class="p">];</span>
<span class="k">GO</span>

<span class="k">CREATE</span> <span class="k">PROCEDURE</span> <span class="p">[</span><span class="n">dbo</span><span class="p">].[</span><span class="n">sp_get_customer</span><span class="p">]</span>
<span class="p">(</span>
        <span class="o">@</span><span class="n">CustomerId</span> <span class="nb">INT</span>
<span class="p">)</span>
<span class="k">AS</span>
<span class="k">BEGIN</span>
        <span class="k">SELECT</span> <span class="o">*</span>
        <span class="k">FROM</span> <span class="p">[</span><span class="n">dbo</span><span class="p">].[</span><span class="n">Customer</span><span class="p">]</span> <span class="k">C</span>
        <span class="k">WHERE</span> <span class="p">(</span><span class="k">C</span><span class="p">.</span><span class="n">Id</span> <span class="o">=</span> <span class="o">@</span><span class="n">CustomerId</span><span class="p">);</span>
<span class="k">END</span>
</pre></div>
</td></tr></table></div>
<p>Below is the code on how to execute a stored procedure mentioned above:</p>
<div class="highlight-c# notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">connection</span> <span class="p">=</span> <span class="k">new</span> <span class="n">SqlConnection</span><span class="p">(</span><span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">).</span><span class="n">EnsureOpen</span><span class="p">())</span>
<span class="p">{</span>
        <span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">reader</span> <span class="p">=</span> <span class="n">connection</span><span class="p">.</span><span class="n">ExecuteReader</span><span class="p">(</span><span class="s">&quot;[dbo].[sp_get_customer]&quot;</span><span class="p">,</span> <span class="k">new</span> <span class="p">{</span> <span class="n">CustomerId</span> <span class="p">=</span> <span class="m">10045</span> <span class="p">},</span> <span class="n">commandType</span><span class="p">:</span> <span class="n">CommandType</span><span class="p">.</span><span class="n">StoredProcedure</span><span class="p">))</span>
        <span class="p">{</span>
                <span class="c1">// Use the data reader here</span>
        <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="executescalar">
<h2>ExecuteScalar<a class="headerlink" href="#executescalar" title="Permalink to this headline">¶</a></h2>
<p>Executes a query from the database. It uses the underlying method <cite>IDbCommand.ExecuteScalar</cite> and returns the first occurence value (first column of first row) of the execution.</p>
<div class="highlight-c# notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">connection</span> <span class="p">=</span> <span class="k">new</span> <span class="n">SqlConnection</span><span class="p">(</span><span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">).</span><span class="n">EnsureOpen</span><span class="p">())</span>
<span class="p">{</span>
        <span class="kt">var</span> <span class="n">maxId</span> <span class="p">=</span> <span class="n">Convert</span><span class="p">.</span><span class="n">ToInt64</span><span class="p">(</span><span class="n">connection</span><span class="p">.</span><span class="n">ExecuteScalar</span><span class="p">(</span><span class="s">&quot;SELECT MAX([Id]) AS MaxId FROM [dbo].[Customer];&quot;</span><span class="p">));</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div>
<p>Let us say the stored procedure below exists.</p>
<div class="highlight-sql notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">DROP</span> <span class="k">PROCEDURE</span> <span class="k">IF</span> <span class="k">EXISTS</span> <span class="p">[</span><span class="n">dbo</span><span class="p">].[</span><span class="n">sp_get_latest_customer_id</span><span class="p">];</span>
<span class="k">GO</span>

<span class="k">CREATE</span> <span class="k">PROCEDURE</span> <span class="p">[</span><span class="n">dbo</span><span class="p">].[</span><span class="n">sp_get_latest_customer_id</span><span class="p">]</span>
<span class="k">AS</span>
<span class="k">BEGIN</span>
        <span class="k">SELECT</span> <span class="k">MAX</span><span class="p">(</span><span class="n">Id</span><span class="p">)</span> <span class="k">FROM</span> <span class="p">[</span><span class="n">dbo</span><span class="p">].[</span><span class="n">Customer</span><span class="p">];</span>
<span class="k">END</span>
</pre></div>
</td></tr></table></div>
<p>Below is the code on how to execute a stored procedure mentioned above:</p>
<div class="highlight-c# notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">connection</span> <span class="p">=</span> <span class="k">new</span> <span class="n">SqlConnection</span><span class="p">(</span><span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">).</span><span class="n">EnsureOpen</span><span class="p">())</span>
<span class="p">{</span>
        <span class="kt">var</span> <span class="n">maxId</span> <span class="p">=</span> <span class="n">Convert</span><span class="p">.</span><span class="n">ToInt64</span><span class="p">(</span><span class="n">connection</span><span class="p">.</span><span class="n">ExecuteScalar</span><span class="p">(</span><span class="s">&quot;[dbo].[sp_get_latest_customer_id]&quot;</span><span class="p">,</span> <span class="n">commandType</span><span class="p">:</span> <span class="n">CommandType</span><span class="p">.</span><span class="n">StoredProcedure</span><span class="p">)));</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div>
<p>A dynamic typed-based call is also provided, see below.</p>
<div class="highlight-c# notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">connection</span> <span class="p">=</span> <span class="k">new</span> <span class="n">SqlConnection</span><span class="p">(</span><span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">).</span><span class="n">EnsureOpen</span><span class="p">())</span>
<span class="p">{</span>
        <span class="kt">var</span> <span class="n">maxId</span> <span class="p">=</span> <span class="n">connection</span><span class="p">.</span><span class="n">ExecuteScalar</span><span class="p">&lt;</span><span class="kt">long</span><span class="p">&gt;(</span><span class="s">&quot;[dbo].[sp_get_latest_customer_id]&quot;</span><span class="p">,</span> <span class="n">commandType</span><span class="p">:</span> <span class="n">CommandType</span><span class="p">.</span><span class="n">StoredProcedure</span><span class="p">));</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="exists">
<h2>Exists<a class="headerlink" href="#exists" title="Permalink to this headline">¶</a></h2>
<p>Check whether the records are existing in the table.</p>
<p>Via DataEntity:</p>
<div class="highlight-c# notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">connection</span> <span class="p">=</span> <span class="k">new</span> <span class="n">SqlConnection</span><span class="p">(</span><span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">).</span><span class="n">EnsureOpen</span><span class="p">())</span>
<span class="p">{</span>
        <span class="kt">var</span> <span class="n">customer</span> <span class="p">=</span> <span class="n">connection</span><span class="p">.</span><span class="n">Query</span><span class="p">&lt;</span><span class="n">Customer</span><span class="p">&gt;(</span><span class="m">10045</span><span class="p">);</span>
        <span class="p">...</span>
        <span class="kt">var</span> <span class="n">result</span> <span class="p">=</span> <span class="n">connection</span><span class="p">.</span><span class="n">Exists</span><span class="p">(</span><span class="n">customer</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div>
<p>Via PrimaryKey:</p>
<div class="highlight-c# notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">connection</span> <span class="p">=</span> <span class="k">new</span> <span class="n">SqlConnection</span><span class="p">(</span><span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">).</span><span class="n">EnsureOpen</span><span class="p">())</span>
<span class="p">{</span>
        <span class="kt">var</span> <span class="n">result</span> <span class="p">=</span> <span class="n">connection</span><span class="p">.</span><span class="n">Exists</span><span class="p">&lt;</span><span class="n">Customer</span><span class="p">&gt;(</span><span class="m">10045</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div>
<p>Via Dynamic:</p>
<div class="highlight-c# notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">connection</span> <span class="p">=</span> <span class="k">new</span> <span class="n">SqlConnection</span><span class="p">(</span><span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">).</span><span class="n">EnsureOpen</span><span class="p">())</span>
<span class="p">{</span>
        <span class="kt">var</span> <span class="n">result</span> <span class="p">=</span> <span class="n">connection</span><span class="p">.</span><span class="n">Exists</span><span class="p">&lt;</span><span class="n">Customer</span><span class="p">&gt;(</span><span class="k">new</span> <span class="p">{</span> <span class="n">Id</span> <span class="p">=</span> <span class="m">10045</span> <span class="p">});</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div>
<p>Expression way:</p>
<div class="highlight-c# notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">connection</span> <span class="p">=</span> <span class="k">new</span> <span class="n">SqlConnection</span><span class="p">(</span><span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">).</span><span class="n">EnsureOpen</span><span class="p">())</span>
<span class="p">{</span>
        <span class="kt">var</span> <span class="n">result</span> <span class="p">=</span> <span class="n">connection</span><span class="p">.</span><span class="n">Exists</span><span class="p">&lt;</span><span class="n">Customer</span><span class="p">&gt;(</span><span class="n">c</span> <span class="p">=&gt;</span> <span class="n">c</span><span class="p">.</span><span class="n">Id</span> <span class="p">==</span> <span class="m">10045</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div>
<p>Explicit way:</p>
<div class="highlight-c# notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">connection</span> <span class="p">=</span> <span class="k">new</span> <span class="n">SqlConnection</span><span class="p">(</span><span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">).</span><span class="n">EnsureOpen</span><span class="p">())</span>
<span class="p">{</span>
        <span class="kt">var</span> <span class="n">result</span> <span class="p">=</span> <span class="n">connection</span><span class="p">.</span><span class="n">Exists</span><span class="p">&lt;</span><span class="n">Customer</span><span class="p">&gt;(</span><span class="k">new</span> <span class="n">QueryField</span><span class="p">(</span><span class="n">nameof</span><span class="p">(</span><span class="n">Order</span><span class="p">.</span><span class="n">CustomerId</span><span class="p">),</span> <span class="m">10045</span><span class="p">));</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div>
<p>Records can also be checked via table name.</p>
<p>Via Dynamic:</p>
<div class="highlight-c# notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">connection</span> <span class="p">=</span> <span class="k">new</span> <span class="n">SqlConnection</span><span class="p">(</span><span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">).</span><span class="n">EnsureOpen</span><span class="p">())</span>
<span class="p">{</span>
        <span class="kt">var</span> <span class="n">result</span> <span class="p">=</span> <span class="n">connection</span><span class="p">.</span><span class="n">Exists</span><span class="p">(</span><span class="s">&quot;Customer&quot;</span><span class="p">,</span> <span class="k">new</span> <span class="p">{</span> <span class="n">Id</span> <span class="p">=</span> <span class="m">10045</span> <span class="p">});</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div>
<p>Explicit way:</p>
<div class="highlight-c# notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">connection</span> <span class="p">=</span> <span class="k">new</span> <span class="n">SqlConnection</span><span class="p">(</span><span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">).</span><span class="n">EnsureOpen</span><span class="p">())</span>
<span class="p">{</span>
        <span class="kt">var</span> <span class="n">result</span> <span class="p">=</span> <span class="n">connection</span><span class="p">.</span><span class="n">Exists</span><span class="p">(</span><span class="s">&quot;Customer&quot;</span><span class="p">,</span> <span class="k">new</span> <span class="n">QueryField</span><span class="p">(</span><span class="n">nameof</span><span class="p">(</span><span class="n">Order</span><span class="p">.</span><span class="n">CustomerId</span><span class="p">),</span> <span class="m">10045</span><span class="p">));</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="getdbsetting">
<h2>GetDbSetting<a class="headerlink" href="#getdbsetting" title="Permalink to this headline">¶</a></h2>
<p>Gets the associated <cite>IDbSetting</cite> object that is currently mapped for the target <cite>IDbConnection</cite> object.</p>
<div class="highlight-c# notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">connection</span> <span class="p">=</span> <span class="k">new</span> <span class="n">SqlConnection</span><span class="p">(</span><span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">).</span><span class="n">EnsureOpen</span><span class="p">())</span>
<span class="p">{</span>
        <span class="kt">var</span> <span class="n">setting</span> <span class="p">=</span> <span class="n">connection</span><span class="p">.</span><span class="n">GetDbSetting</span><span class="p">();</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="getdbhelper">
<h2>GetDbHelper<a class="headerlink" href="#getdbhelper" title="Permalink to this headline">¶</a></h2>
<p>Gets the associated <cite>IDbHelper</cite> object that is currently mapped for the target <cite>IDbConnection</cite> object.</p>
<div class="highlight-c# notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">connection</span> <span class="p">=</span> <span class="k">new</span> <span class="n">SqlConnection</span><span class="p">(</span><span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">).</span><span class="n">EnsureOpen</span><span class="p">())</span>
<span class="p">{</span>
        <span class="kt">var</span> <span class="n">helper</span> <span class="p">=</span> <span class="n">connection</span><span class="p">.</span><span class="n">GetDbHelper</span><span class="p">();</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="getstatementbuilder">
<h2>GetStatementBuilder<a class="headerlink" href="#getstatementbuilder" title="Permalink to this headline">¶</a></h2>
<p>Gets the associated <cite>IStatementBuilder</cite> object that is currently mapped for the target <cite>IDbConnection</cite> object.</p>
<div class="highlight-c# notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">connection</span> <span class="p">=</span> <span class="k">new</span> <span class="n">SqlConnection</span><span class="p">(</span><span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">).</span><span class="n">EnsureOpen</span><span class="p">())</span>
<span class="p">{</span>
        <span class="kt">var</span> <span class="n">builder</span> <span class="p">=</span> <span class="n">connection</span><span class="p">.</span><span class="n">GetStatementBuilder</span><span class="p">();</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="insert">
<h2>Insert<a class="headerlink" href="#insert" title="Permalink to this headline">¶</a></h2>
<p>Inserts a new data in the database.</p>
<div class="highlight-c# notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">connection</span> <span class="p">=</span> <span class="k">new</span> <span class="n">SqlConnection</span><span class="p">(</span><span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">).</span><span class="n">EnsureOpen</span><span class="p">())</span>
<span class="p">{</span>
        <span class="kt">var</span> <span class="n">order</span> <span class="p">=</span> <span class="k">new</span> <span class="n">Order</span><span class="p">()</span>
        <span class="p">{</span>
                <span class="n">CustomerId</span> <span class="p">=</span> <span class="m">10045</span><span class="p">,</span>
                <span class="n">ProductId</span> <span class="p">=</span> <span class="m">12</span>
                <span class="n">Quantity</span> <span class="p">=</span> <span class="m">2</span><span class="p">,</span>
                <span class="n">CreatedDate</span> <span class="p">=</span> <span class="n">DateTime</span><span class="p">.</span><span class="n">UtcNow</span>
        <span class="p">};</span>
        <span class="kt">var</span> <span class="n">id</span> <span class="p">=</span> <span class="n">Convert</span><span class="p">.</span><span class="n">ToInt64</span><span class="p">(</span><span class="n">connection</span><span class="p">.</span><span class="n">Insert</span><span class="p">(</span><span class="n">order</span><span class="p">));</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div>
<p>The return value would be the newly generated <cite>Identity</cite> value, otherwise the value of <cite>PrimaryKey</cite>. If both are not present, then it will return <cite>null</cite>.</p>
<p><strong>Note</strong>: The <cite>identity</cite> column will automatically be filled with newly generated <cite>identity</cite> value right after the insert.</p>
<p>A dynamic typed-based call is also provided when calling this method, see below.</p>
<div class="highlight-c# notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1">// The first type is the entity type, the second type is the result type</span>
<span class="kt">var</span> <span class="n">id</span> <span class="p">=</span> <span class="n">connection</span><span class="p">.</span><span class="n">Insert</span><span class="p">&lt;</span><span class="n">Order</span><span class="p">,</span> <span class="kt">long</span><span class="p">&gt;(</span><span class="n">order</span><span class="p">);</span>
</pre></div>
</td></tr></table></div>
<p><strong>Note</strong>: The first generic type is the type of <cite>data entity</cite> object, the second generic type is the type of the <cite>result</cite>.</p>
<p>Certain columns can also be inserted via table name calls.</p>
<div class="highlight-c# notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">connection</span> <span class="p">=</span> <span class="k">new</span> <span class="n">SqlConnection</span><span class="p">(</span><span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">).</span><span class="n">EnsureOpen</span><span class="p">())</span>
<span class="p">{</span>
        <span class="kt">var</span> <span class="n">entity</span> <span class="p">=</span> <span class="k">new</span>
        <span class="p">{</span>
                <span class="n">CustomerId</span> <span class="p">=</span> <span class="m">10045</span><span class="p">,</span>
                <span class="n">ProductId</span> <span class="p">=</span> <span class="m">12</span>
                <span class="n">Quantity</span> <span class="p">=</span> <span class="m">2</span><span class="p">,</span>
                <span class="n">CreatedDate</span> <span class="p">=</span> <span class="n">DateTime</span><span class="p">.</span><span class="n">UtcNow</span>
        <span class="p">};</span>
        <span class="kt">var</span> <span class="n">id</span> <span class="p">=</span> <span class="n">connection</span><span class="p">.</span><span class="n">Insert</span><span class="p">&lt;</span><span class="kt">long</span><span class="p">&gt;(</span><span class="s">&quot;Order&quot;</span><span class="p">,</span> <span class="n">entity</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div>
<p><strong>Note</strong>: Use the table-name-based calls if the scenario is to only insert targetted columns.</p>
</div>
<div class="section" id="insertall">
<h2>InsertAll<a class="headerlink" href="#insertall" title="Permalink to this headline">¶</a></h2>
<p>Inserts multiple data in the database.</p>
<div class="highlight-c# notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">connection</span> <span class="p">=</span> <span class="k">new</span> <span class="n">SqlConnection</span><span class="p">(</span><span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">).</span><span class="n">EnsureOpen</span><span class="p">())</span>
<span class="p">{</span>
        <span class="kt">var</span> <span class="n">orders</span> <span class="p">=</span> <span class="k">new</span> <span class="n">List</span><span class="p">&lt;</span><span class="n">Order</span><span class="p">&gt;();</span>
        <span class="k">for</span> <span class="p">(</span><span class="kt">var</span> <span class="n">i</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span> <span class="n">i</span> <span class="p">&lt;</span> <span class="m">100</span><span class="p">;</span> <span class="n">i</span><span class="p">++)</span>
        <span class="p">{</span>
                <span class="n">orders</span><span class="p">.</span><span class="n">Add</span><span class="p">(</span><span class="k">new</span> <span class="n">Order</span><span class="p">()</span>
                <span class="p">{</span>
                        <span class="n">CustomerId</span> <span class="p">=</span> <span class="m">10045</span><span class="p">,</span>
                        <span class="n">ProductId</span> <span class="p">=</span> <span class="m">12</span>
                        <span class="n">Quantity</span> <span class="p">=</span> <span class="m">2</span><span class="p">,</span>
                        <span class="n">Price</span> <span class="p">=</span> <span class="m">35.50</span>
                        <span class="n">CreatedDate</span> <span class="p">=</span> <span class="n">DateTime</span><span class="p">.</span><span class="n">UtcNow</span><span class="p">,</span>
                        <span class="n">LastUpdatedUtc</span> <span class="p">=</span> <span class="n">DateTime</span><span class="p">.</span><span class="n">UtcNow</span>
                <span class="p">});</span>
        <span class="p">}</span>
        <span class="n">connection</span><span class="p">.</span><span class="n">InsertAll</span><span class="p">(</span><span class="n">orders</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div>
<p><strong>Note</strong>: All data entities <cite>identity</cite> fields will automatically be filled with its newly generated identity values.</p>
<p>Certain columns can also be inserted via table-name-based calls.</p>
<div class="highlight-c# notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">connection</span> <span class="p">=</span> <span class="k">new</span> <span class="n">SqlConnection</span><span class="p">(</span><span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">).</span><span class="n">EnsureOpen</span><span class="p">())</span>
<span class="p">{</span>
        <span class="kt">var</span> <span class="n">orders</span> <span class="p">=</span> <span class="k">new</span> <span class="n">List</span><span class="p">&lt;</span><span class="kt">dynamic</span><span class="p">&gt;();</span>
        <span class="k">for</span> <span class="p">(</span><span class="kt">var</span> <span class="n">i</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span> <span class="n">i</span> <span class="p">&lt;</span> <span class="m">100</span><span class="p">;</span> <span class="n">i</span><span class="p">++)</span>
        <span class="p">{</span>
                <span class="n">orders</span><span class="p">.</span><span class="n">Add</span><span class="p">(</span><span class="k">new</span>
                <span class="p">{</span>
                        <span class="n">CustomerId</span> <span class="p">=</span> <span class="m">10045</span><span class="p">,</span>
                        <span class="n">ProductId</span> <span class="p">=</span> <span class="m">12</span>
                        <span class="n">Quantity</span> <span class="p">=</span> <span class="m">2</span><span class="p">,</span>
                        <span class="n">CreatedDate</span> <span class="p">=</span> <span class="n">DateTime</span><span class="p">.</span><span class="n">UtcNow</span>
                <span class="p">});</span>
        <span class="p">}</span>
        <span class="kt">var</span> <span class="n">id</span> <span class="p">=</span> <span class="n">connection</span><span class="p">.</span><span class="n">InsertAll</span><span class="p">&lt;</span><span class="kt">long</span><span class="p">&gt;(</span><span class="s">&quot;Order&quot;</span><span class="p">,</span>
                <span class="n">entities</span><span class="p">:</span> <span class="n">orders</span><span class="p">,</span>
                <span class="n">fields</span><span class="p">:</span> <span class="n">Field</span><span class="p">.</span><span class="n">From</span><span class="p">(</span><span class="s">&quot;CustomerId&quot;</span><span class="p">,</span> <span class="s">&quot;ProductId&quot;</span><span class="p">,</span> <span class="s">&quot;Quantity&quot;</span><span class="p">,</span> <span class="s">&quot;CreatedDate&quot;</span><span class="p">));</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div>
<p><strong>Why passing the fields arguments?</strong></p>
<p>By default, the library will use the database columns of the <cite>Order</cite> entity. If the values of some fields were not specified, then the <cite>InsertAll</cite> operation will set it to <cite>null</cite> in the database.</p>
<p><strong>Note</strong>: Use the table-name-based calls if the scenario is to only insert targetted columns.</p>
</div>
<div class="section" id="max">
<h2>Max<a class="headerlink" href="#max" title="Permalink to this headline">¶</a></h2>
<p>Maximizes the target field from the database table.</p>
<p>Dynamic way:</p>
<div class="highlight-c# notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">connection</span> <span class="p">=</span> <span class="k">new</span> <span class="n">SqlConnection</span><span class="p">&gt;(</span><span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">).</span><span class="n">EnsureOpen</span><span class="p">())</span>
<span class="p">{</span>
        <span class="kt">var</span> <span class="n">result</span> <span class="p">=</span> <span class="n">connection</span><span class="p">.</span><span class="n">Max</span><span class="p">&lt;</span><span class="n">Order</span><span class="p">&gt;(</span><span class="n">e</span> <span class="p">=&gt;</span> <span class="n">e</span><span class="p">.</span><span class="n">Price</span><span class="p">,</span>
                <span class="k">new</span> <span class="p">{</span> <span class="n">CustomerId</span> <span class="p">=</span> <span class="m">10045</span><span class="p">,</span> <span class="n">OrderDate</span> <span class="p">=</span> <span class="n">DateTime</span><span class="p">.</span><span class="n">UtcNow</span><span class="p">.</span><span class="n">Date</span> <span class="p">});</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div>
<p>Expression way:</p>
<div class="highlight-c# notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">connection</span> <span class="p">=</span> <span class="k">new</span> <span class="n">SqlConnection</span><span class="p">&gt;(</span><span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">).</span><span class="n">EnsureOpen</span><span class="p">())</span>
<span class="p">{</span>
        <span class="kt">var</span> <span class="n">result</span> <span class="p">=</span> <span class="n">connection</span><span class="p">.</span><span class="n">Max</span><span class="p">&lt;</span><span class="n">Order</span><span class="p">&gt;(</span><span class="n">e</span> <span class="p">=&gt;</span> <span class="n">e</span><span class="p">.</span><span class="n">Price</span><span class="p">,</span>
                <span class="n">e</span> <span class="p">=&gt;</span> <span class="n">e</span><span class="p">.</span><span class="n">CustomerId</span> <span class="p">==</span> <span class="m">10045</span> <span class="p">&amp;&amp;</span> <span class="n">e</span><span class="p">.</span><span class="n">OrderDate</span> <span class="p">==</span> <span class="n">DateTime</span><span class="p">.</span><span class="n">UtcNow</span><span class="p">.</span><span class="n">Date</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div>
<p>Explicit way:</p>
<div class="highlight-c# notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8
9</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">connection</span> <span class="p">=</span> <span class="k">new</span> <span class="n">SqlConnection</span><span class="p">&gt;(</span><span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">).</span><span class="n">EnsureOpen</span><span class="p">())</span>
<span class="p">{</span>
        <span class="kt">var</span> <span class="n">queryGroup</span> <span class="p">=</span> <span class="k">new</span> <span class="n">QueryGroup</span>
        <span class="p">(</span>
                <span class="k">new</span> <span class="nf">QueryField</span><span class="p">(</span><span class="n">nameof</span><span class="p">(</span><span class="n">Order</span><span class="p">.</span><span class="n">CustomerId</span><span class="p">),</span> <span class="m">10045</span><span class="p">),</span>
                <span class="k">new</span> <span class="nf">QueryField</span><span class="p">(</span><span class="n">nameof</span><span class="p">(</span><span class="n">Order</span><span class="p">.</span><span class="n">OrderDate</span><span class="p">),</span> <span class="n">DateTime</span><span class="p">.</span><span class="n">UtcNow</span><span class="p">.</span><span class="n">Date</span><span class="p">)</span>
        <span class="p">);</span>
        <span class="kt">var</span> <span class="n">result</span> <span class="p">=</span> <span class="n">connection</span><span class="p">.</span><span class="n">Max</span><span class="p">&lt;</span><span class="n">Order</span><span class="p">&gt;(</span><span class="n">e</span> <span class="p">=&gt;</span> <span class="n">e</span><span class="p">.</span><span class="n">Price</span><span class="p">,</span> <span class="n">queryGroup</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div>
<p>Records can all also be maximized via table name.</p>
<p>Dynamic way:</p>
<div class="highlight-c# notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">connection</span> <span class="p">=</span> <span class="k">new</span> <span class="n">SqlConnection</span><span class="p">&gt;(</span><span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">).</span><span class="n">EnsureOpen</span><span class="p">())</span>
<span class="p">{</span>
        <span class="kt">var</span> <span class="n">result</span> <span class="p">=</span> <span class="n">connection</span><span class="p">.</span><span class="n">Max</span><span class="p">(</span><span class="s">&quot;Order&quot;</span><span class="p">,</span> <span class="k">new</span> <span class="n">Field</span><span class="p">(</span><span class="s">&quot;Price&quot;</span><span class="p">),</span> <span class="k">new</span> <span class="p">{</span> <span class="n">CustomerId</span> <span class="p">=</span> <span class="m">10045</span> <span class="p">});</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div>
<p>Explicit way:</p>
<div class="highlight-c# notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8
9</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">connection</span> <span class="p">=</span> <span class="k">new</span> <span class="n">SqlConnection</span><span class="p">&gt;(</span><span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">).</span><span class="n">EnsureOpen</span><span class="p">())</span>
<span class="p">{</span>
        <span class="kt">var</span> <span class="n">queryGroup</span> <span class="p">=</span> <span class="k">new</span> <span class="n">QueryGroup</span>
        <span class="p">(</span>
                <span class="k">new</span> <span class="nf">QueryField</span><span class="p">(</span><span class="n">nameof</span><span class="p">(</span><span class="n">Order</span><span class="p">.</span><span class="n">CustomerId</span><span class="p">),</span> <span class="m">10045</span><span class="p">),</span>
                <span class="k">new</span> <span class="nf">QueryField</span><span class="p">(</span><span class="n">nameof</span><span class="p">(</span><span class="n">Order</span><span class="p">.</span><span class="n">OrderDate</span><span class="p">),</span> <span class="n">DateTime</span><span class="p">.</span><span class="n">UtcNow</span><span class="p">.</span><span class="n">Date</span><span class="p">)</span>
        <span class="p">);</span>
        <span class="kt">var</span> <span class="n">result</span> <span class="p">=</span> <span class="n">connection</span><span class="p">.</span><span class="n">Max</span><span class="p">(</span><span class="s">&quot;Order&quot;</span><span class="p">,</span> <span class="k">new</span> <span class="n">Field</span><span class="p">(</span><span class="s">&quot;Price&quot;</span><span class="p">),</span> <span class="n">queryGroup</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div>
<p><strong>Note</strong>: By setting the <cite>where</cite> argument to blank would count all the records. Exactly the same as <cite>MaxAll</cite> operation.</p>
</div>
<div class="section" id="maxall">
<h2>MaxAll<a class="headerlink" href="#maxall" title="Permalink to this headline">¶</a></h2>
<p>Maximizes the target field from all data of the database table.</p>
<div class="highlight-c# notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">connection</span> <span class="p">=</span> <span class="k">new</span> <span class="n">SqlConnection</span><span class="p">&gt;(</span><span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">).</span><span class="n">EnsureOpen</span><span class="p">())</span>
<span class="p">{</span>
        <span class="kt">var</span> <span class="n">result</span> <span class="p">=</span> <span class="n">connection</span><span class="p">.</span><span class="n">MaxAll</span><span class="p">&lt;</span><span class="n">Order</span><span class="p">&gt;(</span><span class="n">e</span> <span class="p">=&gt;</span> <span class="n">e</span><span class="p">.</span><span class="n">Price</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div>
<p>All records can all also be maximized via table name.</p>
<p>Dynamic way:</p>
<div class="highlight-c# notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">connection</span> <span class="p">=</span> <span class="k">new</span> <span class="n">SqlConnection</span><span class="p">&gt;(</span><span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">).</span><span class="n">EnsureOpen</span><span class="p">())</span>
<span class="p">{</span>
        <span class="kt">var</span> <span class="n">result</span> <span class="p">=</span> <span class="n">connection</span><span class="p">.</span><span class="n">MaxAll</span><span class="p">(</span><span class="s">&quot;Order&quot;</span><span class="p">,</span> <span class="k">new</span> <span class="n">Field</span><span class="p">(</span><span class="s">&quot;Price&quot;</span><span class="p">));</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="merge">
<h2>Merge<a class="headerlink" href="#merge" title="Permalink to this headline">¶</a></h2>
<p>Merges a data entity or dynamic object into the database.</p>
<div class="highlight-c# notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">connection</span> <span class="p">=</span> <span class="k">new</span> <span class="n">SqlConnection</span><span class="p">(</span><span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">).</span><span class="n">EnsureOpen</span><span class="p">())</span>
<span class="p">{</span>
        <span class="kt">var</span> <span class="n">order</span> <span class="p">=</span> <span class="n">connection</span><span class="p">.</span><span class="n">Query</span><span class="p">&lt;</span><span class="n">Order</span><span class="p">&gt;(</span><span class="m">1</span><span class="p">);</span>
        <span class="n">order</span><span class="p">.</span><span class="n">Quantity</span> <span class="p">=</span> <span class="m">5</span><span class="p">;</span>
        <span class="n">UpdatedDate</span> <span class="p">=</span> <span class="n">DateTime</span><span class="p">.</span><span class="n">UtcNow</span><span class="p">;</span>
        <span class="n">connection</span><span class="p">.</span><span class="n">Merge</span><span class="p">(</span><span class="n">order</span><span class="p">,</span> <span class="n">Field</span><span class="p">.</span><span class="n">Parse</span><span class="p">&lt;</span><span class="n">Order</span><span class="p">&gt;(</span><span class="n">o</span> <span class="p">=&gt;</span> <span class="n">o</span><span class="p">.</span><span class="n">Id</span><span class="p">));</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div>
<p>By default, the <cite>Merge</cite> operation is using the data entity <cite>PrimaryKey</cite> as the qualifier if the second parameter is omitted.</p>
<div class="highlight-c# notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">connection</span> <span class="p">=</span> <span class="k">new</span> <span class="n">SqlConnection</span><span class="p">(</span><span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">).</span><span class="n">EnsureOpen</span><span class="p">())</span>
<span class="p">{</span>
        <span class="kt">var</span> <span class="n">order</span> <span class="p">=</span> <span class="n">connection</span><span class="p">.</span><span class="n">Query</span><span class="p">&lt;</span><span class="n">Order</span><span class="p">&gt;(</span><span class="m">1</span><span class="p">);</span>
        <span class="n">order</span><span class="p">.</span><span class="n">Quantity</span> <span class="p">=</span> <span class="m">5</span><span class="p">;</span>
        <span class="n">UpdatedDate</span> <span class="p">=</span> <span class="n">DateTime</span><span class="p">.</span><span class="n">UtcNow</span><span class="p">;</span>
        <span class="n">connection</span><span class="p">.</span><span class="n">Merge</span><span class="p">(</span><span class="n">order</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div>
<p>The qualifiers can also be set with the combination of multiple fields. When using this, please note that the qualifiers are also corresponding with the table index for performance purposes.</p>
<div class="highlight-c# notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">connection</span> <span class="p">=</span> <span class="k">new</span> <span class="n">SqlConnection</span><span class="p">(</span><span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">).</span><span class="n">EnsureOpen</span><span class="p">())</span>
<span class="p">{</span>
        <span class="kt">var</span> <span class="n">order</span> <span class="p">=</span> <span class="n">connection</span><span class="p">.</span><span class="n">Query</span><span class="p">&lt;</span><span class="n">Order</span><span class="p">&gt;(</span><span class="m">1</span><span class="p">);</span>
        <span class="n">order</span><span class="p">.</span><span class="n">Quantity</span> <span class="p">=</span> <span class="m">5</span><span class="p">;</span>
        <span class="n">UpdatedDate</span> <span class="p">=</span> <span class="n">DateTime</span><span class="p">.</span><span class="n">UtcNow</span><span class="p">;</span>
        <span class="n">connection</span><span class="p">.</span><span class="n">Merge</span><span class="p">(</span><span class="n">order</span><span class="p">,</span> <span class="n">Field</span><span class="p">.</span><span class="n">From</span><span class="p">(</span><span class="s">&quot;CustomerId&quot;</span><span class="p">,</span> <span class="s">&quot;ProductId&quot;</span><span class="p">));</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div>
<p><strong>Note</strong>: The data entity <cite>identity</cite> field will automatically be filled with newly generated identity value if the <cite>Merge</cite> operation has inserted a new record in the database.</p>
<p>Certain columns can also be merged via table name calls.</p>
<div class="highlight-c# notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">connection</span> <span class="p">=</span> <span class="k">new</span> <span class="n">SqlConnection</span><span class="p">(</span><span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">).</span><span class="n">EnsureOpen</span><span class="p">())</span>
<span class="p">{</span>
        <span class="c1">// Instantiate a dynamic object (not really an &quot;Order&quot; object)</span>
        <span class="kt">var</span> <span class="n">entity</span> <span class="p">=</span> <span class="k">new</span>
        <span class="p">{</span>
                <span class="n">Id</span> <span class="p">=</span> <span class="m">1</span><span class="p">,</span>
                <span class="n">Quantity</span> <span class="p">=</span> <span class="m">5</span><span class="p">,</span>
                <span class="n">UpdatedDate</span> <span class="p">=</span> <span class="n">DateTime</span><span class="p">.</span><span class="n">UtcNow</span>
        <span class="p">};</span>
        <span class="n">connection</span><span class="p">.</span><span class="n">Merge</span><span class="p">(</span><span class="s">&quot;Order&quot;</span><span class="p">,</span> <span class="n">entity</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div>
<p><strong>Note</strong>: Use the table-name-based calls if the scenario is to only merge targetted columns.</p>
</div>
<div class="section" id="mergeall">
<h2>MergeAll<a class="headerlink" href="#mergeall" title="Permalink to this headline">¶</a></h2>
<p>Merges the multiple data entity or dynamic objects into the database.</p>
<div class="highlight-c# notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">connection</span> <span class="p">=</span> <span class="k">new</span> <span class="n">SqlConnection</span><span class="p">(</span><span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">).</span><span class="n">EnsureOpen</span><span class="p">())</span>
<span class="p">{</span>
        <span class="kt">var</span> <span class="n">orders</span> <span class="p">=</span> <span class="n">connection</span><span class="p">.</span><span class="n">Query</span><span class="p">&lt;</span><span class="n">Order</span><span class="p">&gt;(</span><span class="n">o</span> <span class="p">=&gt;</span> <span class="n">o</span><span class="p">.</span><span class="n">CustomerId</span> <span class="p">==</span> <span class="m">10045</span><span class="p">);</span>
        <span class="k">for</span> <span class="p">(</span><span class="kt">var</span> <span class="n">i</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span> <span class="n">i</span> <span class="p">&lt;</span> <span class="m">100</span><span class="p">;</span> <span class="n">i</span><span class="p">++)</span>
        <span class="p">{</span>
                <span class="kt">var</span> <span class="n">order</span> <span class="p">=</span> <span class="n">orders</span><span class="p">.</span><span class="n">ElementAt</span><span class="p">(</span><span class="n">i</span><span class="p">);</span>
                <span class="n">order</span><span class="p">.</span><span class="n">Quantity</span> <span class="p">=</span> <span class="m">5</span><span class="p">;</span>
                <span class="n">order</span><span class="p">.</span><span class="n">LastUpdatedUtc</span> <span class="p">=</span> <span class="n">DateTime</span><span class="p">.</span><span class="n">UtcNow</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="n">connection</span><span class="p">.</span><span class="n">MergeAll</span><span class="p">(</span><span class="n">orders</span><span class="p">,</span> <span class="n">Field</span><span class="p">.</span><span class="n">From</span><span class="p">(</span><span class="s">&quot;Id&quot;</span><span class="p">));</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div>
<p>Same as <cite>Merge</cite> operation, the <cite>MergeAll</cite> operation is also using the <cite>PrimaryKey</cite> as the default qualifier if the argument is not provided during the calls.</p>
<div class="highlight-c# notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">connection</span> <span class="p">=</span> <span class="k">new</span> <span class="n">SqlConnection</span><span class="p">(</span><span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">).</span><span class="n">EnsureOpen</span><span class="p">())</span>
<span class="p">{</span>
        <span class="kt">var</span> <span class="n">orders</span> <span class="p">=</span> <span class="n">connection</span><span class="p">.</span><span class="n">Query</span><span class="p">&lt;</span><span class="n">Order</span><span class="p">&gt;(</span><span class="n">o</span> <span class="p">=&gt;</span> <span class="n">o</span><span class="p">.</span><span class="n">CustomerId</span> <span class="p">==</span> <span class="m">10045</span><span class="p">);</span>
        <span class="k">for</span> <span class="p">(</span><span class="kt">var</span> <span class="n">i</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span> <span class="n">i</span> <span class="p">&lt;</span> <span class="m">100</span><span class="p">;</span> <span class="n">i</span><span class="p">++)</span>
        <span class="p">{</span>
                <span class="kt">var</span> <span class="n">order</span> <span class="p">=</span> <span class="n">orders</span><span class="p">.</span><span class="n">ElementAt</span><span class="p">(</span><span class="n">i</span><span class="p">);</span>
                <span class="n">order</span><span class="p">.</span><span class="n">Quantity</span> <span class="p">=</span> <span class="m">5</span><span class="p">;</span>
                <span class="n">order</span><span class="p">.</span><span class="n">LastUpdatedUtc</span> <span class="p">=</span> <span class="n">DateTime</span><span class="p">.</span><span class="n">UtcNow</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="n">connection</span><span class="p">.</span><span class="n">MergeAll</span><span class="p">(</span><span class="n">orders</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div>
<p>Also, multiple columns can be used as the qualifiers for <cite>MergeAll</cite> operation.</p>
<div class="highlight-c# notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">connection</span> <span class="p">=</span> <span class="k">new</span> <span class="n">SqlConnection</span><span class="p">(</span><span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">).</span><span class="n">EnsureOpen</span><span class="p">())</span>
<span class="p">{</span>
        <span class="kt">var</span> <span class="n">orders</span> <span class="p">=</span> <span class="n">connection</span><span class="p">.</span><span class="n">Query</span><span class="p">&lt;</span><span class="n">Order</span><span class="p">&gt;(</span><span class="n">o</span> <span class="p">=&gt;</span> <span class="n">o</span><span class="p">.</span><span class="n">CustomerId</span> <span class="p">==</span> <span class="m">10045</span><span class="p">);</span>
        <span class="k">for</span> <span class="p">(</span><span class="kt">var</span> <span class="n">i</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span> <span class="n">i</span> <span class="p">&lt;</span> <span class="m">100</span><span class="p">;</span> <span class="n">i</span><span class="p">++)</span>
        <span class="p">{</span>
                <span class="kt">var</span> <span class="n">order</span> <span class="p">=</span> <span class="n">orders</span><span class="p">.</span><span class="n">ElementAt</span><span class="p">(</span><span class="n">i</span><span class="p">);</span>
                <span class="n">order</span><span class="p">.</span><span class="n">Quantity</span> <span class="p">=</span> <span class="m">5</span><span class="p">;</span>
                <span class="n">order</span><span class="p">.</span><span class="n">LastUpdatedUtc</span> <span class="p">=</span> <span class="n">DateTime</span><span class="p">.</span><span class="n">UtcNow</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="n">connection</span><span class="p">.</span><span class="n">MergeAll</span><span class="p">(</span><span class="n">orders</span><span class="p">,</span> <span class="n">Field</span><span class="p">.</span><span class="n">From</span><span class="p">(</span><span class="s">&quot;CustomerId&quot;</span><span class="p">,</span> <span class="s">&quot;ProductId&quot;</span><span class="p">));</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div>
<p><strong>Note</strong>: The data entities <cite>identity</cite> fields will automatically be filled with its newly generated identity values.</p>
<p>All fields are being merged when calling the typed-based method. However, certain columns can be merged when using the table name calls.</p>
<div class="highlight-c# notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">connection</span> <span class="p">=</span> <span class="k">new</span> <span class="n">SqlConnection</span><span class="p">(</span><span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">).</span><span class="n">EnsureOpen</span><span class="p">())</span>
<span class="p">{</span>
        <span class="kt">var</span> <span class="n">orders</span> <span class="p">=</span> <span class="n">connection</span><span class="p">.</span><span class="n">Query</span><span class="p">&lt;</span><span class="n">Order</span><span class="p">&gt;(</span><span class="n">o</span> <span class="p">=&gt;</span> <span class="n">o</span><span class="p">.</span><span class="n">CustomerId</span> <span class="p">==</span> <span class="m">10045</span><span class="p">);</span>
        <span class="kt">var</span> <span class="n">mergeables</span> <span class="p">=</span> <span class="k">new</span> <span class="n">List</span><span class="p">&lt;</span><span class="kt">dynamic</span><span class="p">&gt;();</span>
        <span class="k">for</span> <span class="p">(</span><span class="kt">var</span> <span class="n">i</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span> <span class="n">i</span> <span class="p">&lt;</span> <span class="m">100</span><span class="p">;</span> <span class="n">i</span><span class="p">++)</span>
        <span class="p">{</span>
                <span class="kt">var</span> <span class="n">order</span> <span class="p">=</span> <span class="n">orders</span><span class="p">.</span><span class="n">ElementAt</span><span class="p">(</span><span class="n">i</span><span class="p">);</span>
                <span class="n">mergeables</span><span class="p">.</span><span class="n">Add</span><span class="p">(</span><span class="k">new</span>
                <span class="p">{</span>
                        <span class="n">Id</span> <span class="p">=</span> <span class="n">order</span><span class="p">.</span><span class="n">Id</span><span class="p">,</span>
                        <span class="n">Quantity</span> <span class="p">=</span> <span class="m">5</span><span class="p">,</span>
                        <span class="n">LastUpdatedUtc</span> <span class="p">=</span> <span class="n">DateTime</span><span class="p">.</span><span class="n">UtcNow</span>
                <span class="p">});</span>
        <span class="p">}</span>
        <span class="n">connection</span><span class="p">.</span><span class="n">MergeAll</span><span class="p">(</span><span class="s">&quot;Order&quot;</span><span class="p">,</span>
                <span class="n">entities</span><span class="p">:</span> <span class="n">mergeables</span><span class="p">,</span>
                <span class="n">fields</span><span class="p">:</span> <span class="n">Field</span><span class="p">.</span><span class="n">From</span><span class="p">(</span><span class="s">&quot;Id&quot;</span><span class="p">,</span> <span class="s">&quot;Quantity&quot;</span><span class="p">,</span> <span class="s">&quot;LastUpdatedUtc&quot;</span><span class="p">));</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div>
<p><strong>Why passing the fields arguments?</strong></p>
<p>Be aware on this behavior since this is a merge operation. By default, the library will use the database columns of the <cite>Order</cite> entity. If the values to that fields were not specified, then the <cite>MergeAll</cite> operation will set it to <cite>null</cite> in the database. By setting the <cite>fields</cite> argument, it will only merge the listed <cite>fields</cite> in the batch operations.</p>
<p><strong>Note</strong>: Use the table-name-based calls if the scenario is to only merge targetted columns.</p>
</div>
<div class="section" id="min">
<h2>Min<a class="headerlink" href="#min" title="Permalink to this headline">¶</a></h2>
<p>Minimizes the target field from the database table.</p>
<p>Dynamic way:</p>
<div class="highlight-c# notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">connection</span> <span class="p">=</span> <span class="k">new</span> <span class="n">SqlConnection</span><span class="p">&gt;(</span><span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">).</span><span class="n">EnsureOpen</span><span class="p">())</span>
<span class="p">{</span>
        <span class="kt">var</span> <span class="n">result</span> <span class="p">=</span> <span class="n">connection</span><span class="p">.</span><span class="n">Min</span><span class="p">&lt;</span><span class="n">Order</span><span class="p">&gt;(</span><span class="n">e</span> <span class="p">=&gt;</span> <span class="n">e</span><span class="p">.</span><span class="n">Price</span><span class="p">,</span>
                <span class="k">new</span> <span class="p">{</span> <span class="n">CustomerId</span> <span class="p">=</span> <span class="m">10045</span><span class="p">,</span> <span class="n">OrderDate</span> <span class="p">=</span> <span class="n">DateTime</span><span class="p">.</span><span class="n">UtcNow</span><span class="p">.</span><span class="n">Date</span> <span class="p">});</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div>
<p>Expression way:</p>
<div class="highlight-c# notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">connection</span> <span class="p">=</span> <span class="k">new</span> <span class="n">SqlConnection</span><span class="p">&gt;(</span><span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">).</span><span class="n">EnsureOpen</span><span class="p">())</span>
<span class="p">{</span>
        <span class="kt">var</span> <span class="n">result</span> <span class="p">=</span> <span class="n">connection</span><span class="p">.</span><span class="n">Min</span><span class="p">&lt;</span><span class="n">Order</span><span class="p">&gt;(</span><span class="n">e</span> <span class="p">=&gt;</span> <span class="n">e</span><span class="p">.</span><span class="n">Price</span><span class="p">,</span>
                <span class="n">e</span> <span class="p">=&gt;</span> <span class="n">e</span><span class="p">.</span><span class="n">CustomerId</span> <span class="p">==</span> <span class="m">10045</span> <span class="p">&amp;&amp;</span> <span class="n">e</span><span class="p">.</span><span class="n">OrderDate</span> <span class="p">==</span> <span class="n">DateTime</span><span class="p">.</span><span class="n">UtcNow</span><span class="p">.</span><span class="n">Date</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div>
<p>Explicit way:</p>
<div class="highlight-c# notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8
9</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">connection</span> <span class="p">=</span> <span class="k">new</span> <span class="n">SqlConnection</span><span class="p">&gt;(</span><span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">).</span><span class="n">EnsureOpen</span><span class="p">())</span>
<span class="p">{</span>
        <span class="kt">var</span> <span class="n">queryGroup</span> <span class="p">=</span> <span class="k">new</span> <span class="n">QueryGroup</span>
        <span class="p">(</span>
                <span class="k">new</span> <span class="nf">QueryField</span><span class="p">(</span><span class="n">nameof</span><span class="p">(</span><span class="n">Order</span><span class="p">.</span><span class="n">CustomerId</span><span class="p">),</span> <span class="m">10045</span><span class="p">),</span>
                <span class="k">new</span> <span class="nf">QueryField</span><span class="p">(</span><span class="n">nameof</span><span class="p">(</span><span class="n">Order</span><span class="p">.</span><span class="n">OrderDate</span><span class="p">),</span> <span class="n">DateTime</span><span class="p">.</span><span class="n">UtcNow</span><span class="p">.</span><span class="n">Date</span><span class="p">)</span>
        <span class="p">);</span>
        <span class="kt">var</span> <span class="n">result</span> <span class="p">=</span> <span class="n">connection</span><span class="p">.</span><span class="n">Min</span><span class="p">&lt;</span><span class="n">Order</span><span class="p">&gt;(</span><span class="n">e</span> <span class="p">=&gt;</span> <span class="n">e</span><span class="p">.</span><span class="n">Price</span><span class="p">,</span> <span class="n">queryGroup</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div>
<p>Records can all also be minimized via table name.</p>
<p>Dynamic way:</p>
<div class="highlight-c# notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">connection</span> <span class="p">=</span> <span class="k">new</span> <span class="n">SqlConnection</span><span class="p">&gt;(</span><span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">).</span><span class="n">EnsureOpen</span><span class="p">())</span>
<span class="p">{</span>
        <span class="kt">var</span> <span class="n">result</span> <span class="p">=</span> <span class="n">connection</span><span class="p">.</span><span class="n">Min</span><span class="p">(</span><span class="s">&quot;Order&quot;</span><span class="p">,</span> <span class="k">new</span> <span class="n">Field</span><span class="p">(</span><span class="s">&quot;Price&quot;</span><span class="p">),</span> <span class="k">new</span> <span class="p">{</span> <span class="n">CustomerId</span> <span class="p">=</span> <span class="m">10045</span> <span class="p">});</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div>
<p>Explicit way:</p>
<div class="highlight-c# notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8
9</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">connection</span> <span class="p">=</span> <span class="k">new</span> <span class="n">SqlConnection</span><span class="p">&gt;(</span><span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">).</span><span class="n">EnsureOpen</span><span class="p">())</span>
<span class="p">{</span>
        <span class="kt">var</span> <span class="n">queryGroup</span> <span class="p">=</span> <span class="k">new</span> <span class="n">QueryGroup</span>
        <span class="p">(</span>
                <span class="k">new</span> <span class="nf">QueryField</span><span class="p">(</span><span class="n">nameof</span><span class="p">(</span><span class="n">Order</span><span class="p">.</span><span class="n">CustomerId</span><span class="p">),</span> <span class="m">10045</span><span class="p">),</span>
                <span class="k">new</span> <span class="nf">QueryField</span><span class="p">(</span><span class="n">nameof</span><span class="p">(</span><span class="n">Order</span><span class="p">.</span><span class="n">OrderDate</span><span class="p">),</span> <span class="n">DateTime</span><span class="p">.</span><span class="n">UtcNow</span><span class="p">.</span><span class="n">Date</span><span class="p">)</span>
        <span class="p">);</span>
        <span class="kt">var</span> <span class="n">result</span> <span class="p">=</span> <span class="n">connection</span><span class="p">.</span><span class="n">Min</span><span class="p">(</span><span class="s">&quot;Order&quot;</span><span class="p">,</span> <span class="k">new</span> <span class="n">Field</span><span class="p">(</span><span class="s">&quot;Price&quot;</span><span class="p">),</span> <span class="n">queryGroup</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div>
<p><strong>Note</strong>: By setting the <cite>where</cite> argument to blank would count all the records. Exactly the same as <cite>MinAll</cite> operation.</p>
</div>
<div class="section" id="minall">
<h2>MinAll<a class="headerlink" href="#minall" title="Permalink to this headline">¶</a></h2>
<p>Minimizes the target field from all data of the database table.</p>
<div class="highlight-c# notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">connection</span> <span class="p">=</span> <span class="k">new</span> <span class="n">SqlConnection</span><span class="p">&gt;(</span><span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">).</span><span class="n">EnsureOpen</span><span class="p">())</span>
<span class="p">{</span>
        <span class="kt">var</span> <span class="n">result</span> <span class="p">=</span> <span class="n">connection</span><span class="p">.</span><span class="n">MinAll</span><span class="p">&lt;</span><span class="n">Order</span><span class="p">&gt;(</span><span class="n">e</span> <span class="p">=&gt;</span> <span class="n">e</span><span class="p">.</span><span class="n">Price</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div>
<p>All records can all also be minimized via table name.</p>
<p>Dynamic way:</p>
<div class="highlight-c# notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">connection</span> <span class="p">=</span> <span class="k">new</span> <span class="n">SqlConnection</span><span class="p">&gt;(</span><span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">).</span><span class="n">EnsureOpen</span><span class="p">())</span>
<span class="p">{</span>
        <span class="kt">var</span> <span class="n">result</span> <span class="p">=</span> <span class="n">connection</span><span class="p">.</span><span class="n">MinAll</span><span class="p">(</span><span class="s">&quot;Order&quot;</span><span class="p">,</span> <span class="k">new</span> <span class="n">Field</span><span class="p">(</span><span class="s">&quot;Price&quot;</span><span class="p">));</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="query">
<h2>Query<a class="headerlink" href="#query" title="Permalink to this headline">¶</a></h2>
<p>Queries a data from the database.</p>
<p>Via PrimaryKey:</p>
<div class="highlight-c# notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">connection</span> <span class="p">=</span> <span class="k">new</span> <span class="n">SqlConnection</span><span class="p">(</span><span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">).</span><span class="n">EnsureOpen</span><span class="p">())</span>
<span class="p">{</span>
        <span class="kt">var</span> <span class="n">customer</span> <span class="p">=</span> <span class="n">connection</span><span class="p">.</span><span class="n">Query</span><span class="p">&lt;</span><span class="n">Customer</span><span class="p">&gt;(</span><span class="m">10045</span><span class="p">).</span><span class="n">FirstOrDefault</span><span class="p">();</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div>
<p>Via Dynamic:</p>
<div class="highlight-c# notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">connection</span> <span class="p">=</span> <span class="k">new</span> <span class="n">SqlConnection</span><span class="p">(</span><span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">).</span><span class="n">EnsureOpen</span><span class="p">())</span>
<span class="p">{</span>
        <span class="kt">var</span> <span class="n">customer</span> <span class="p">=</span> <span class="n">connection</span><span class="p">.</span><span class="n">Query</span><span class="p">&lt;</span><span class="n">Customer</span><span class="p">&gt;(</span><span class="k">new</span> <span class="p">{</span> <span class="n">Id</span> <span class="p">=</span> <span class="m">10045</span> <span class="p">}).</span><span class="n">FirstOrDefault</span><span class="p">();</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div>
<p>Expression way:</p>
<div class="highlight-c# notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">connection</span> <span class="p">=</span> <span class="k">new</span> <span class="n">SqlConnection</span><span class="p">(</span><span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">).</span><span class="n">EnsureOpen</span><span class="p">())</span>
<span class="p">{</span>
        <span class="kt">var</span> <span class="n">customers</span> <span class="p">=</span> <span class="n">connection</span><span class="p">.</span><span class="n">Query</span><span class="p">&lt;</span><span class="n">Customer</span><span class="p">&gt;(</span><span class="n">c</span> <span class="p">=&gt;</span> <span class="n">c</span><span class="p">.</span><span class="n">Id</span> <span class="p">==</span> <span class="m">10045</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div>
<p>Explicit way:</p>
<div class="highlight-c# notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">connection</span> <span class="p">=</span> <span class="k">new</span> <span class="n">SqlConnection</span><span class="p">(</span><span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">).</span><span class="n">EnsureOpen</span><span class="p">())</span>
<span class="p">{</span>
        <span class="kt">var</span> <span class="n">customers</span> <span class="p">=</span> <span class="n">connection</span><span class="p">.</span><span class="n">Query</span><span class="p">&lt;</span><span class="n">Customer</span><span class="p">&gt;(</span><span class="k">new</span> <span class="n">QueryField</span><span class="p">(</span><span class="n">nameof</span><span class="p">(</span><span class="n">Customer</span><span class="p">.</span><span class="n">Id</span><span class="p">),</span> <span class="m">10045</span><span class="p">));</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div>
<p>With ordering.</p>
<div class="highlight-c# notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">connection</span> <span class="p">=</span> <span class="k">new</span> <span class="n">SqlConnection</span><span class="p">(</span><span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">).</span><span class="n">EnsureOpen</span><span class="p">())</span>
<span class="p">{</span>
        <span class="kt">var</span> <span class="n">orderBy</span> <span class="p">=</span> <span class="k">new</span>
        <span class="p">{</span>
                <span class="n">Id</span> <span class="p">=</span> <span class="n">Order</span><span class="p">.</span><span class="n">Ascending</span>
        <span class="p">};</span>
        <span class="kt">var</span> <span class="n">orders</span> <span class="p">=</span> <span class="n">connection</span><span class="p">.</span><span class="n">Query</span><span class="p">&lt;</span><span class="n">Order</span><span class="p">&gt;(</span><span class="k">new</span> <span class="p">{</span> <span class="n">CustomerId</span> <span class="p">=</span> <span class="m">10045</span> <span class="p">},</span> <span class="n">orderBy</span><span class="p">:</span> <span class="n">orderBy</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div>
<p>With hint.</p>
<div class="highlight-c# notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">connection</span> <span class="p">=</span> <span class="k">new</span> <span class="n">SqlConnection</span><span class="p">(</span><span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">).</span><span class="n">EnsureOpen</span><span class="p">())</span>
<span class="p">{</span>
        <span class="kt">var</span> <span class="n">customers</span> <span class="p">=</span> <span class="n">connection</span><span class="p">.</span><span class="n">Query</span><span class="p">&lt;</span><span class="n">Customer</span><span class="p">&gt;(</span><span class="k">new</span> <span class="p">{</span> <span class="n">CustomerId</span> <span class="p">=</span> <span class="m">10045</span> <span class="p">},</span> <span class="n">hints</span><span class="p">:</span> <span class="n">SqlTableHints</span><span class="p">.</span><span class="n">NoLock</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div>
<p>Certain columns can also be queried via table-name-based calls.</p>
<div class="highlight-c# notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">connection</span> <span class="p">=</span> <span class="k">new</span> <span class="n">SqlConnection</span><span class="p">(</span><span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">).</span><span class="n">EnsureOpen</span><span class="p">())</span>
<span class="p">{</span>
        <span class="kt">var</span> <span class="n">orderBy</span> <span class="p">=</span> <span class="k">new</span>
        <span class="p">{</span>
                <span class="n">Id</span> <span class="p">=</span> <span class="n">Order</span><span class="p">.</span><span class="n">Ascending</span>
        <span class="p">};</span>
        <span class="kt">var</span> <span class="n">orders</span> <span class="p">=</span> <span class="n">connection</span><span class="p">.</span><span class="n">Query</span><span class="p">(</span><span class="s">&quot;Order&quot;</span><span class="p">,</span>
                <span class="k">new</span> <span class="p">{</span> <span class="n">CustomerId</span> <span class="p">=</span> <span class="m">10045</span> <span class="p">},</span>
                <span class="n">fields</span><span class="p">:</span> <span class="n">Field</span><span class="p">.</span><span class="n">From</span><span class="p">(</span><span class="s">&quot;Id&quot;</span><span class="p">,</span> <span class="s">&quot;CustomerId&quot;</span><span class="p">,</span> <span class="s">&quot;CreatedDateUtc&quot;</span><span class="p">),</span>
                <span class="n">orderBy</span><span class="p">:</span> <span class="n">orderBy</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div>
<p><strong>Note</strong>: By setting the <cite>where</cite> argument to blank would query all the records. Exactly the same as <cite>QueryAll</cite> operation.</p>
</div>
<div class="section" id="queryall">
<h2>QueryAll<a class="headerlink" href="#queryall" title="Permalink to this headline">¶</a></h2>
<p>Query all the data from the database.</p>
<div class="highlight-c# notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">connection</span> <span class="p">=</span> <span class="k">new</span> <span class="n">SqlConnection</span><span class="p">(</span><span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">).</span><span class="n">EnsureOpen</span><span class="p">())</span>
<span class="p">{</span>
        <span class="kt">var</span> <span class="n">customers</span> <span class="p">=</span> <span class="n">connection</span><span class="p">.</span><span class="n">QueryAll</span><span class="p">&lt;</span><span class="n">Customer</span><span class="p">&gt;();</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div>
<p>With ordering.</p>
<div class="highlight-c# notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">connection</span> <span class="p">=</span> <span class="k">new</span> <span class="n">SqlConnection</span><span class="p">(</span><span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">).</span><span class="n">EnsureOpen</span><span class="p">())</span>
<span class="p">{</span>
        <span class="kt">var</span> <span class="n">orderBy</span> <span class="p">=</span> <span class="k">new</span>
        <span class="p">{</span>
                <span class="n">Id</span> <span class="p">=</span> <span class="n">Order</span><span class="p">.</span><span class="n">Ascending</span>
        <span class="p">};</span>
        <span class="kt">var</span> <span class="n">customers</span> <span class="p">=</span> <span class="n">connection</span><span class="p">.</span><span class="n">QueryAll</span><span class="p">&lt;</span><span class="n">Customer</span><span class="p">&gt;(</span><span class="n">orderBy</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div>
<p>With hint.</p>
<div class="highlight-c# notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">connection</span> <span class="p">=</span> <span class="k">new</span> <span class="n">SqlConnection</span><span class="p">(</span><span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">).</span><span class="n">EnsureOpen</span><span class="p">())</span>
<span class="p">{</span>
        <span class="kt">var</span> <span class="n">customers</span> <span class="p">=</span> <span class="n">connection</span><span class="p">.</span><span class="n">QueryAll</span><span class="p">&lt;</span><span class="n">Customer</span><span class="p">&gt;(</span><span class="n">SqlTableHints</span><span class="p">.</span><span class="n">NoLock</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div>
<p>Certain columns can also be queried via table-name-based calls.</p>
<div class="highlight-c# notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">connection</span> <span class="p">=</span> <span class="k">new</span> <span class="n">SqlConnection</span><span class="p">(</span><span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">).</span><span class="n">EnsureOpen</span><span class="p">())</span>
<span class="p">{</span>
        <span class="kt">var</span> <span class="n">orderBy</span> <span class="p">=</span> <span class="k">new</span>
        <span class="p">{</span>
                <span class="n">Id</span> <span class="p">=</span> <span class="n">Order</span><span class="p">.</span><span class="n">Ascending</span>
        <span class="p">};</span>
        <span class="kt">var</span> <span class="n">orders</span> <span class="p">=</span> <span class="n">connection</span><span class="p">.</span><span class="n">QueryAll</span><span class="p">(</span><span class="s">&quot;Order&quot;</span><span class="p">,</span>
                <span class="n">fields</span><span class="p">:</span> <span class="n">Field</span><span class="p">.</span><span class="n">From</span><span class="p">(</span><span class="s">&quot;Id&quot;</span><span class="p">,</span> <span class="s">&quot;CustomerId&quot;</span><span class="p">,</span> <span class="s">&quot;CreatedDateUtc&quot;</span><span class="p">),</span>
                <span class="n">orderBy</span><span class="p">:</span> <span class="n">orderBy</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="querymultiple">
<h2>QueryMultiple<a class="headerlink" href="#querymultiple" title="Permalink to this headline">¶</a></h2>
<p>Query a multiple resultsets from the database.</p>
<p>Below is an example of how to query a customer where the <cite>Id</cite> field is equals to <cite>10045</cite>, and at the same time, querying all the orders connected to this customer since yesterday.
The result is an instance of a <cite>Tuple</cite> object.</p>
<div class="highlight-c# notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">connection</span> <span class="p">=</span> <span class="k">new</span> <span class="n">SqlConnection</span><span class="p">(</span><span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">).</span><span class="n">EnsureOpen</span><span class="p">())</span>
<span class="p">{</span>
        <span class="c1">// The parent Id</span>
        <span class="kt">var</span> <span class="n">customerId</span> <span class="p">=</span> <span class="m">10045</span><span class="p">;</span>

        <span class="c1">// Get the parent customer, and the child objects</span>
        <span class="kt">var</span> <span class="n">result</span> <span class="p">=</span> <span class="n">connection</span><span class="p">.</span><span class="n">QueryMultiple</span><span class="p">&lt;</span><span class="n">Customer</span><span class="p">,</span> <span class="n">Order</span><span class="p">&gt;(</span>
                <span class="n">customer</span> <span class="p">=&gt;</span> <span class="n">customer</span><span class="p">.</span><span class="n">Id</span> <span class="p">==</span> <span class="n">customerId</span><span class="p">,</span>
                <span class="n">order</span> <span class="p">=&gt;</span> <span class="n">order</span><span class="p">.</span><span class="n">CustomerId</span> <span class="p">==</span> <span class="n">customerId</span><span class="p">);</span>

        <span class="c1">// Read the customer</span>
        <span class="kt">var</span> <span class="n">customer</span> <span class="p">=</span> <span class="n">result</span><span class="p">.</span><span class="n">Item1</span><span class="p">.</span><span class="n">FirstOrDefault</span><span class="p">();</span>

        <span class="c1">// Read the orders</span>
        <span class="kt">var</span> <span class="n">orders</span> <span class="p">=</span> <span class="n">result</span><span class="p">.</span><span class="n">Item2</span><span class="p">.</span><span class="n">ToList</span><span class="p">();</span>
        <span class="n">orders</span><span class="p">.</span><span class="n">ForEach</span><span class="p">(</span><span class="n">order</span> <span class="p">=&gt;</span>
        <span class="p">{</span>
                <span class="c1">// Do the stuffs for the &#39;order&#39; here</span>
        <span class="p">});</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div>
<p>This method has supported until the last tupled dynamic type of the <cite>Tuple</cite> class. The current maximum tupled dynamic type is 7.</p>
<div class="highlight-c# notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="n">DbConnection</span><span class="p">.</span><span class="n">Query</span><span class="p">&lt;</span><span class="n">T1</span><span class="p">,</span> <span class="n">T2</span><span class="p">,</span> <span class="n">T3</span><span class="p">,</span> <span class="n">T4</span><span class="p">,</span> <span class="n">T5</span><span class="p">,</span> <span class="n">T6</span><span class="p">,</span> <span class="n">T7</span><span class="p">&gt;(</span>
        <span class="n">where1</span><span class="p">:</span> <span class="p">&lt;</span><span class="n">Expression</span> <span class="k">for</span> <span class="n">T1</span><span class="p">&gt;,</span>
        <span class="n">where2</span><span class="p">:</span> <span class="p">&lt;</span><span class="n">Expression</span> <span class="k">for</span> <span class="n">T2</span><span class="p">&gt;,</span>
        <span class="n">where3</span><span class="p">:</span> <span class="p">&lt;</span><span class="n">Expression</span> <span class="k">for</span> <span class="n">T3</span><span class="p">&gt;,</span>
        <span class="n">where4</span><span class="p">:</span> <span class="p">&lt;</span><span class="n">Expression</span> <span class="k">for</span> <span class="n">T4</span><span class="p">&gt;,</span>
        <span class="n">where5</span><span class="p">:</span> <span class="p">&lt;</span><span class="n">Expression</span> <span class="k">for</span> <span class="n">T5</span><span class="p">&gt;,</span>
        <span class="n">where6</span><span class="p">:</span> <span class="p">&lt;</span><span class="n">Expression</span> <span class="k">for</span> <span class="n">T6</span><span class="p">&gt;,</span>
        <span class="n">where7</span><span class="p">:</span> <span class="p">&lt;</span><span class="n">Expression</span> <span class="k">for</span> <span class="n">T7</span><span class="p">&gt;;</span>
</pre></div>
</td></tr></table></div>
<p>Notice above, there were <cite>where&lt;T&lt;Num&gt;&gt;</cite> arguments. These arguments are targetting the specific index of the type on the ‘QueryMultiple’ operation. This method is not meant for joining the result of each type, but instead, it is used to execute the query execution at once.</p>
<p>Below is an example of how to query the list of customers based on different US states.</p>
<div class="highlight-c# notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">connection</span> <span class="p">=</span> <span class="k">new</span> <span class="n">SqlConnection</span><span class="p">(</span><span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">).</span><span class="n">EnsureOpen</span><span class="p">())</span>
<span class="p">{</span>
        <span class="kt">var</span> <span class="n">result</span> <span class="p">=</span> <span class="n">connection</span><span class="p">.</span><span class="n">QueryMultiple</span><span class="p">&lt;</span><span class="n">Customer</span><span class="p">,</span> <span class="n">Customer</span><span class="p">,</span> <span class="n">Customer</span><span class="p">,</span> <span class="n">Customer</span><span class="p">,</span> <span class="n">Customer</span><span class="p">,</span> <span class="n">Customer</span><span class="p">,</span> <span class="n">Customer</span><span class="p">&gt;(</span>
                <span class="n">where1</span><span class="p">:</span> <span class="n">c</span> <span class="p">=&gt;</span> <span class="n">c</span><span class="p">.</span><span class="n">State</span> <span class="p">==</span> <span class="s">&quot;California&quot;</span><span class="p">,</span>
                <span class="n">where2</span><span class="p">:</span> <span class="n">c</span> <span class="p">=&gt;</span> <span class="n">c</span><span class="p">.</span><span class="n">State</span> <span class="p">==</span> <span class="s">&quot;Florida&quot;</span><span class="p">,</span>
                <span class="n">where3</span><span class="p">:</span> <span class="n">c</span> <span class="p">=&gt;</span> <span class="n">c</span><span class="p">.</span><span class="n">State</span> <span class="p">==</span> <span class="s">&quot;Texas&quot;</span><span class="p">,</span>
                <span class="n">where4</span><span class="p">:</span> <span class="n">c</span> <span class="p">=&gt;</span> <span class="n">c</span><span class="p">.</span><span class="n">State</span> <span class="p">==</span> <span class="s">&quot;Washington&quot;</span><span class="p">,</span>
                <span class="n">where5</span><span class="p">:</span> <span class="n">c</span> <span class="p">=&gt;</span> <span class="n">c</span><span class="p">.</span><span class="n">State</span> <span class="p">==</span> <span class="s">&quot;Michigan&quot;</span><span class="p">,</span>
                <span class="n">where6</span><span class="p">:</span> <span class="n">c</span> <span class="p">=&gt;</span> <span class="n">c</span><span class="p">.</span><span class="n">State</span> <span class="p">==</span> <span class="s">&quot;Arizona&quot;</span><span class="p">,</span>
                <span class="n">where7</span><span class="p">:</span> <span class="n">c</span> <span class="p">=&gt;</span> <span class="n">c</span><span class="p">.</span><span class="n">State</span> <span class="p">==</span> <span class="s">&quot;New York&quot;</span><span class="p">);</span>

        <span class="c1">// Read the customers through its equivalent &#39;Item&lt;N&gt;&#39; property</span>
        <span class="kt">var</span> <span class="n">californiaCustomers</span> <span class="p">=</span> <span class="n">result</span><span class="p">.</span><span class="n">Item1</span><span class="p">;</span>
        <span class="kt">var</span> <span class="n">floridaCustomers</span> <span class="p">=</span> <span class="n">result</span><span class="p">.</span><span class="n">Item2</span><span class="p">;</span>
        <span class="kt">var</span> <span class="n">texasCustomers</span> <span class="p">=</span> <span class="n">result</span><span class="p">.</span><span class="n">Item3</span><span class="p">;</span>
        <span class="kt">var</span> <span class="n">washingtonCustomers</span> <span class="p">=</span> <span class="n">result</span><span class="p">.</span><span class="n">Item4</span><span class="p">;</span>
        <span class="kt">var</span> <span class="n">michiganCustomers</span> <span class="p">=</span> <span class="n">result</span><span class="p">.</span><span class="n">Item5</span><span class="p">;</span>
        <span class="kt">var</span> <span class="n">arizonaCustomers</span> <span class="p">=</span> <span class="n">result</span><span class="p">.</span><span class="n">Item6</span><span class="p">;</span>
        <span class="kt">var</span> <span class="n">newYorkCustomers</span> <span class="p">=</span> <span class="n">result</span><span class="p">.</span><span class="n">Item7</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div>
<p>Notice as well, there are other arguments defined like <cite>orderBy&lt;N&gt;</cite>, <cite>top&lt;N&gt;</cite> and <cite>hints&lt;N&gt;</cite>. These are the targetted arguments if the caller wants to define the behavior of the query for that target type based on the element-index provided.</p>
<p>Below is the implementation of the the 2 target types tupled.</p>
<div class="highlight-c# notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8
9</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="n">DbConnection</span><span class="p">.</span><span class="n">Query</span><span class="p">&lt;</span><span class="n">T1</span><span class="p">,</span> <span class="n">T2</span><span class="p">&gt;(</span>
        <span class="n">where1</span><span class="p">:</span> <span class="p">&lt;</span><span class="n">Expression</span> <span class="k">for</span> <span class="n">T1</span><span class="p">&gt;,</span>
        <span class="n">where2</span><span class="p">:</span> <span class="p">&lt;</span><span class="n">Expression</span> <span class="k">for</span> <span class="n">T2</span><span class="p">&gt;,</span>
        <span class="n">orderBy1</span><span class="p">:</span> <span class="p">&lt;</span><span class="n">Optional</span> <span class="n">OrderExpression</span> <span class="k">for</span> <span class="n">T1</span><span class="p">&gt;,</span>
        <span class="n">top1</span><span class="p">:</span> <span class="p">&lt;</span><span class="n">Optional</span> <span class="n">RowFilter</span> <span class="k">for</span> <span class="n">T1</span><span class="p">&gt;,</span>
        <span class="n">hints1</span><span class="p">:</span> <span class="p">&lt;</span><span class="n">Optional</span> <span class="n">QueryOptimizer</span> <span class="k">for</span> <span class="n">T1</span><span class="p">&gt;,</span>
        <span class="n">orderBy2</span><span class="p">:</span> <span class="p">&lt;</span><span class="n">Optional</span> <span class="n">OrderExpression</span> <span class="k">for</span> <span class="n">T2</span><span class="p">&gt;,</span>
        <span class="n">top2</span><span class="p">:</span> <span class="p">&lt;</span><span class="n">Optional</span> <span class="n">RowFilter</span> <span class="k">for</span> <span class="n">T2</span><span class="p">&gt;,</span>
        <span class="n">hints2</span><span class="p">:</span> <span class="p">&lt;</span><span class="n">Optional</span> <span class="n">QueryOptimizer</span> <span class="k">for</span> <span class="n">T2</span><span class="p">&gt;);</span>
</pre></div>
</td></tr></table></div>
<p>Below is a example of how to do a query that returns a 100 customers from <cite>California</cite> ordered by their <cite>SSID</cite> optimized by <cite>NOLOCK</cite> keyword, and also, a list of 1000 customers from <cite>Florida</cite> with <cite>READPAST</cite> query optimizer ordered by their <cite>LastName</cite> followed by <cite>FirstName</cite>.</p>
<div class="highlight-c# notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">connection</span> <span class="p">=</span> <span class="k">new</span> <span class="n">SqlConnection</span><span class="p">(</span><span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">).</span><span class="n">EnsureOpen</span><span class="p">())</span>
<span class="p">{</span>
        <span class="kt">var</span> <span class="n">result</span> <span class="p">=</span> <span class="n">connection</span><span class="p">.</span><span class="n">QueryMultiple</span><span class="p">&lt;</span><span class="n">Customer</span><span class="p">,</span> <span class="n">Customer</span><span class="p">&gt;(</span>
                <span class="n">where1</span><span class="p">:</span> <span class="n">c</span> <span class="p">=&gt;</span> <span class="n">c</span><span class="p">.</span><span class="n">State</span> <span class="p">==</span> <span class="s">&quot;California&quot;</span><span class="p">,</span>
                <span class="n">orderBy</span><span class="p">:</span> <span class="n">OrderField</span><span class="p">.</span><span class="n">Parse</span><span class="p">(</span><span class="k">new</span> <span class="p">{</span> <span class="n">SsId</span> <span class="p">=</span> <span class="n">Order</span><span class="p">.</span><span class="n">Ascending</span> <span class="p">}),</span> <span class="cm">/* At RepoDb.Enumerations */</span>
                <span class="n">top1</span><span class="p">:</span> <span class="m">100</span><span class="p">,</span>
                <span class="n">hints1</span><span class="p">:</span> <span class="n">SqlTableHints</span><span class="p">.</span><span class="n">NoLock</span><span class="p">,</span> <span class="cm">/* Can write WITH (NOLOCK) */</span><span class="p">,</span>
                <span class="n">where2</span><span class="p">:</span> <span class="n">c</span> <span class="p">=&gt;</span> <span class="n">c</span><span class="p">.</span><span class="n">State</span> <span class="p">==</span> <span class="s">&quot;Florida&quot;</span><span class="p">,</span>
                <span class="n">orderBy2</span><span class="p">:</span> <span class="n">OrderField</span><span class="p">.</span><span class="n">Parse</span><span class="p">(</span><span class="k">new</span> <span class="p">{</span> <span class="n">LastName</span> <span class="p">=</span> <span class="n">Order</span><span class="p">.</span><span class="n">Ascending</span><span class="p">,</span> <span class="n">FirstName</span> <span class="n">Order</span><span class="p">.</span><span class="n">Ascending</span> <span class="p">}),</span> <span class="cm">/* At RepoDb.Enumerations */</span>
                <span class="n">top2</span><span class="p">:</span> <span class="m">1000</span><span class="p">,</span>
                <span class="n">hints2</span><span class="p">:</span> <span class="s">&quot;WITH (READPAST) /* Can use SqlTableHints.ReadPast */</span>
        <span class="p">);</span>

        <span class="c1">// Read the customers through its equivalent &#39;Item&lt;N&gt;&#39; property</span>
        <span class="kt">var</span> <span class="n">californiaCustomers</span> <span class="p">=</span> <span class="n">result</span><span class="p">.</span><span class="n">Item1</span><span class="p">;</span>
        <span class="kt">var</span> <span class="n">floridaCustomers</span> <span class="p">=</span> <span class="n">result</span><span class="p">.</span><span class="n">Item2</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div>
<p><strong>Note</strong>: This method does not support the <cite>Object-Based</cite> query tree expression.</p>
</div>
<div class="section" id="sum">
<h2>Sum<a class="headerlink" href="#sum" title="Permalink to this headline">¶</a></h2>
<p>Summarizes the target field from the database table.</p>
<p>Dynamic way:</p>
<div class="highlight-c# notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">connection</span> <span class="p">=</span> <span class="k">new</span> <span class="n">SqlConnection</span><span class="p">&gt;(</span><span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">).</span><span class="n">EnsureOpen</span><span class="p">())</span>
<span class="p">{</span>
        <span class="kt">var</span> <span class="n">result</span> <span class="p">=</span> <span class="n">connection</span><span class="p">.</span><span class="n">Sum</span><span class="p">&lt;</span><span class="n">Order</span><span class="p">&gt;(</span><span class="n">e</span> <span class="p">=&gt;</span> <span class="n">e</span><span class="p">.</span><span class="n">Price</span><span class="p">,</span>
                <span class="k">new</span> <span class="p">{</span> <span class="n">CustomerId</span> <span class="p">=</span> <span class="m">10045</span><span class="p">,</span> <span class="n">OrderDate</span> <span class="p">=</span> <span class="n">DateTime</span><span class="p">.</span><span class="n">UtcNow</span><span class="p">.</span><span class="n">Date</span> <span class="p">});</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div>
<p>Expression way:</p>
<div class="highlight-c# notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">connection</span> <span class="p">=</span> <span class="k">new</span> <span class="n">SqlConnection</span><span class="p">&gt;(</span><span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">).</span><span class="n">EnsureOpen</span><span class="p">())</span>
<span class="p">{</span>
        <span class="kt">var</span> <span class="n">result</span> <span class="p">=</span> <span class="n">connection</span><span class="p">.</span><span class="n">Sum</span><span class="p">&lt;</span><span class="n">Order</span><span class="p">&gt;(</span><span class="n">e</span> <span class="p">=&gt;</span> <span class="n">e</span><span class="p">.</span><span class="n">Price</span><span class="p">,</span>
                <span class="n">e</span> <span class="p">=&gt;</span> <span class="n">e</span><span class="p">.</span><span class="n">CustomerId</span> <span class="p">==</span> <span class="m">10045</span> <span class="p">&amp;&amp;</span> <span class="n">e</span><span class="p">.</span><span class="n">OrderDate</span> <span class="p">==</span> <span class="n">DateTime</span><span class="p">.</span><span class="n">UtcNow</span><span class="p">.</span><span class="n">Date</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div>
<p>Explicit way:</p>
<div class="highlight-c# notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8
9</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">connection</span> <span class="p">=</span> <span class="k">new</span> <span class="n">SqlConnection</span><span class="p">&gt;(</span><span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">).</span><span class="n">EnsureOpen</span><span class="p">())</span>
<span class="p">{</span>
        <span class="kt">var</span> <span class="n">queryGroup</span> <span class="p">=</span> <span class="k">new</span> <span class="n">QueryGroup</span>
        <span class="p">(</span>
                <span class="k">new</span> <span class="nf">QueryField</span><span class="p">(</span><span class="n">nameof</span><span class="p">(</span><span class="n">Order</span><span class="p">.</span><span class="n">CustomerId</span><span class="p">),</span> <span class="m">10045</span><span class="p">),</span>
                <span class="k">new</span> <span class="nf">QueryField</span><span class="p">(</span><span class="n">nameof</span><span class="p">(</span><span class="n">Order</span><span class="p">.</span><span class="n">OrderDate</span><span class="p">),</span> <span class="n">DateTime</span><span class="p">.</span><span class="n">UtcNow</span><span class="p">.</span><span class="n">Date</span><span class="p">)</span>
        <span class="p">);</span>
        <span class="kt">var</span> <span class="n">result</span> <span class="p">=</span> <span class="n">connection</span><span class="p">.</span><span class="n">Sum</span><span class="p">&lt;</span><span class="n">Order</span><span class="p">&gt;(</span><span class="n">e</span> <span class="p">=&gt;</span> <span class="n">e</span><span class="p">.</span><span class="n">Price</span><span class="p">,</span> <span class="n">queryGroup</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div>
<p>Records can all also be summarized via table name.</p>
<p>Dynamic way:</p>
<div class="highlight-c# notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">connection</span> <span class="p">=</span> <span class="k">new</span> <span class="n">SqlConnection</span><span class="p">&gt;(</span><span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">).</span><span class="n">EnsureOpen</span><span class="p">())</span>
<span class="p">{</span>
        <span class="kt">var</span> <span class="n">result</span> <span class="p">=</span> <span class="n">connection</span><span class="p">.</span><span class="n">Sum</span><span class="p">(</span><span class="s">&quot;Order&quot;</span><span class="p">,</span> <span class="k">new</span> <span class="n">Field</span><span class="p">(</span><span class="s">&quot;Price&quot;</span><span class="p">),</span> <span class="k">new</span> <span class="p">{</span> <span class="n">CustomerId</span> <span class="p">=</span> <span class="m">10045</span> <span class="p">});</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div>
<p>Explicit way:</p>
<div class="highlight-c# notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8
9</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">connection</span> <span class="p">=</span> <span class="k">new</span> <span class="n">SqlConnection</span><span class="p">&gt;(</span><span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">).</span><span class="n">EnsureOpen</span><span class="p">())</span>
<span class="p">{</span>
        <span class="kt">var</span> <span class="n">queryGroup</span> <span class="p">=</span> <span class="k">new</span> <span class="n">QueryGroup</span>
        <span class="p">(</span>
                <span class="k">new</span> <span class="nf">QueryField</span><span class="p">(</span><span class="n">nameof</span><span class="p">(</span><span class="n">Order</span><span class="p">.</span><span class="n">CustomerId</span><span class="p">),</span> <span class="m">10045</span><span class="p">),</span>
                <span class="k">new</span> <span class="nf">QueryField</span><span class="p">(</span><span class="n">nameof</span><span class="p">(</span><span class="n">Order</span><span class="p">.</span><span class="n">OrderDate</span><span class="p">),</span> <span class="n">DateTime</span><span class="p">.</span><span class="n">UtcNow</span><span class="p">.</span><span class="n">Date</span><span class="p">)</span>
        <span class="p">);</span>
        <span class="kt">var</span> <span class="n">result</span> <span class="p">=</span> <span class="n">connection</span><span class="p">.</span><span class="n">Sum</span><span class="p">(</span><span class="s">&quot;Order&quot;</span><span class="p">,</span> <span class="k">new</span> <span class="n">Field</span><span class="p">(</span><span class="s">&quot;Price&quot;</span><span class="p">),</span> <span class="n">queryGroup</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div>
<p><strong>Note</strong>: By setting the <cite>where</cite> argument to blank would count all the records. Exactly the same as <cite>SumAll</cite> operation.</p>
</div>
<div class="section" id="sumall">
<h2>SumAll<a class="headerlink" href="#sumall" title="Permalink to this headline">¶</a></h2>
<p>Summarizes the target field from all data of the database table.</p>
<div class="highlight-c# notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">connection</span> <span class="p">=</span> <span class="k">new</span> <span class="n">SqlConnection</span><span class="p">&gt;(</span><span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">).</span><span class="n">EnsureOpen</span><span class="p">())</span>
<span class="p">{</span>
        <span class="kt">var</span> <span class="n">result</span> <span class="p">=</span> <span class="n">connection</span><span class="p">.</span><span class="n">SumAll</span><span class="p">&lt;</span><span class="n">Order</span><span class="p">&gt;(</span><span class="n">e</span> <span class="p">=&gt;</span> <span class="n">e</span><span class="p">.</span><span class="n">Price</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div>
<p>All records can all also be summarized via table name.</p>
<p>Dynamic way:</p>
<div class="highlight-c# notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">connection</span> <span class="p">=</span> <span class="k">new</span> <span class="n">SqlConnection</span><span class="p">&gt;(</span><span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">).</span><span class="n">EnsureOpen</span><span class="p">())</span>
<span class="p">{</span>
        <span class="kt">var</span> <span class="n">result</span> <span class="p">=</span> <span class="n">connection</span><span class="p">.</span><span class="n">SumAll</span><span class="p">(</span><span class="s">&quot;Order&quot;</span><span class="p">,</span> <span class="k">new</span> <span class="n">Field</span><span class="p">(</span><span class="s">&quot;Price&quot;</span><span class="p">));</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="truncate">
<h2>Truncate<a class="headerlink" href="#truncate" title="Permalink to this headline">¶</a></h2>
<p>Truncates a table from the database.</p>
<div class="highlight-c# notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">connection</span> <span class="p">=</span> <span class="k">new</span> <span class="n">SqlConnection</span><span class="p">(</span><span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">).</span><span class="n">EnsureOpen</span><span class="p">())</span>
<span class="p">{</span>
        <span class="n">connection</span><span class="p">.</span><span class="n">Truncate</span><span class="p">&lt;</span><span class="n">Customer</span><span class="p">&gt;();</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div>
<p>Table can also be truncated via table name.</p>
<div class="highlight-c# notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">connection</span> <span class="p">=</span> <span class="k">new</span> <span class="n">SqlConnection</span><span class="p">(</span><span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">).</span><span class="n">EnsureOpen</span><span class="p">())</span>
<span class="p">{</span>
        <span class="n">connection</span><span class="p">.</span><span class="n">Truncate</span><span class="p">(</span><span class="s">&quot;Customer&quot;</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="update">
<h2>Update<a class="headerlink" href="#update" title="Permalink to this headline">¶</a></h2>
<p>Updates an existing data in the database.</p>
<p>Let us say an <cite>Order</cite> object was queried from the database.</p>
<div class="highlight-c# notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1">// Query a data from the database</span>
<span class="kt">var</span> <span class="n">order</span> <span class="p">=</span> <span class="n">connection</span><span class="p">.</span><span class="n">Query</span><span class="p">&lt;</span><span class="n">Order</span><span class="p">&gt;(</span><span class="m">1002</span><span class="p">).</span><span class="n">FirstOrDefault</span><span class="p">();</span>

<span class="c1">// Set the target properties</span>
<span class="n">order</span><span class="p">.</span><span class="n">Quantity</span> <span class="p">=</span> <span class="m">5</span><span class="p">;</span>
<span class="n">order</span><span class="p">.</span><span class="n">UpdateDate</span> <span class="p">=</span> <span class="n">DateTime</span><span class="p">.</span><span class="n">UtcNow</span><span class="p">;</span>
</pre></div>
</td></tr></table></div>
<p>Via DataEntity:</p>
<div class="highlight-c# notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">connection</span> <span class="p">=</span> <span class="k">new</span> <span class="n">SqlConnection</span><span class="p">(</span><span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">).</span><span class="n">EnsureOpen</span><span class="p">())</span>
<span class="p">{</span>
        <span class="kt">var</span> <span class="n">result</span> <span class="p">=</span> <span class="n">connection</span><span class="p">.</span><span class="n">Update</span><span class="p">&lt;</span><span class="n">Order</span><span class="p">&gt;(</span><span class="n">order</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div>
<p>Via PrimaryKey:</p>
<div class="highlight-c# notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">connection</span> <span class="p">=</span> <span class="k">new</span> <span class="n">SqlConnection</span><span class="p">(</span><span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">).</span><span class="n">EnsureOpen</span><span class="p">())</span>
<span class="p">{</span>
        <span class="kt">var</span> <span class="n">result</span> <span class="p">=</span> <span class="n">connection</span><span class="p">.</span><span class="n">Update</span><span class="p">&lt;</span><span class="n">Order</span><span class="p">&gt;(</span><span class="n">order</span><span class="p">,</span> <span class="m">1002</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div>
<p><strong>Note</strong>: The library uses the <cite>PrimaryKey</cite> as the default qualifier for <cite>Update</cite> operation. This also applies when updating the <cite>data entity</cite> object itself. This call will throw an exception if the data entity does not have a <cite>primary key</cite>.</p>
<p>Via Dynamic:</p>
<div class="highlight-c# notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">connection</span> <span class="p">=</span> <span class="k">new</span> <span class="n">SqlConnection</span><span class="p">(</span><span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">).</span><span class="n">EnsureOpen</span><span class="p">())</span>
<span class="p">{</span>
        <span class="kt">var</span> <span class="n">result</span> <span class="p">=</span> <span class="n">connection</span><span class="p">.</span><span class="n">Update</span><span class="p">&lt;</span><span class="n">Order</span><span class="p">&gt;(</span><span class="n">order</span><span class="p">,</span> <span class="k">new</span> <span class="p">{</span> <span class="n">Id</span> <span class="p">=</span> <span class="m">1002</span> <span class="p">});</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div>
<p>Expression way:</p>
<div class="highlight-c# notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">connection</span> <span class="p">=</span> <span class="k">new</span> <span class="n">SqlConnection</span><span class="p">(</span><span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">).</span><span class="n">EnsureOpen</span><span class="p">())</span>
<span class="p">{</span>
        <span class="kt">var</span> <span class="n">result</span> <span class="p">=</span> <span class="n">connection</span><span class="p">.</span><span class="n">Update</span><span class="p">&lt;</span><span class="n">Order</span><span class="p">&gt;(</span><span class="n">order</span><span class="p">,</span> <span class="n">o</span> <span class="p">=&gt;</span> <span class="n">o</span><span class="p">.</span><span class="n">Id</span> <span class="p">==</span> <span class="m">1002</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div>
<p>Explicit way:</p>
<div class="highlight-c# notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">connection</span> <span class="p">=</span> <span class="k">new</span> <span class="n">SqlConnection</span><span class="p">(</span><span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">).</span><span class="n">EnsureOpen</span><span class="p">())</span>
<span class="p">{</span>
        <span class="kt">var</span> <span class="n">result</span> <span class="p">=</span> <span class="n">connection</span><span class="p">.</span><span class="n">Update</span><span class="p">(</span><span class="n">order</span><span class="p">,</span> <span class="k">new</span> <span class="n">QueryField</span><span class="p">(</span><span class="n">nameof</span><span class="p">(</span><span class="n">Order</span><span class="p">.</span><span class="n">Id</span><span class="p">),</span> <span class="m">1002</span><span class="p">));</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div>
<p>Record can also be updated via table name.</p>
<p>Dynamic way:</p>
<div class="highlight-c# notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">connection</span> <span class="p">=</span> <span class="k">new</span> <span class="n">SqlConnection</span><span class="p">(</span><span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">).</span><span class="n">EnsureOpen</span><span class="p">())</span>
<span class="p">{</span>
        <span class="c1">// Instantiate a dynamic object (not really an &quot;Order&quot; object)</span>
        <span class="kt">var</span> <span class="n">entity</span> <span class="p">=</span> <span class="k">new</span>
        <span class="p">{</span>
                <span class="n">Quantity</span> <span class="p">=</span> <span class="m">5</span><span class="p">,</span>
                <span class="n">UpdateDate</span> <span class="p">=</span> <span class="n">DateTime</span><span class="p">.</span><span class="n">UtcNow</span>
        <span class="p">};</span>
        <span class="kt">var</span> <span class="n">result</span> <span class="p">=</span> <span class="n">connection</span><span class="p">.</span><span class="n">Update</span><span class="p">(</span><span class="s">&quot;Order&quot;</span><span class="p">,</span> <span class="n">entity</span><span class="p">,</span> <span class="k">new</span> <span class="p">{</span> <span class="n">Id</span> <span class="p">=</span> <span class="m">1002</span> <span class="p">});</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div>
<p>Explicit way:</p>
<div class="highlight-c# notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">connection</span> <span class="p">=</span> <span class="k">new</span> <span class="n">SqlConnection</span><span class="p">(</span><span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">).</span><span class="n">EnsureOpen</span><span class="p">())</span>
<span class="p">{</span>
        <span class="c1">// Instantiate a dynamic object (not really an &quot;Order&quot; object)</span>
        <span class="kt">var</span> <span class="n">entity</span> <span class="p">=</span> <span class="k">new</span>
        <span class="p">{</span>
                <span class="n">Quantity</span> <span class="p">=</span> <span class="m">5</span><span class="p">,</span>
                <span class="n">UpdateDate</span> <span class="p">=</span> <span class="n">DateTime</span><span class="p">.</span><span class="n">UtcNow</span>
        <span class="p">};</span>
        <span class="kt">var</span> <span class="n">result</span> <span class="p">=</span> <span class="n">connection</span><span class="p">.</span><span class="n">Update</span><span class="p">(</span><span class="s">&quot;Order&quot;</span><span class="p">,</span> <span class="n">entity</span><span class="p">,</span> <span class="k">new</span> <span class="n">QueryField</span><span class="p">(</span><span class="s">&quot;Id&quot;</span><span class="p">,</span> <span class="m">1002</span><span class="p">));</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="updateall">
<h2>UpdateAll<a class="headerlink" href="#updateall" title="Permalink to this headline">¶</a></h2>
<p>Updates existing multiple data in the database.</p>
<div class="highlight-c# notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">connection</span> <span class="p">=</span> <span class="k">new</span> <span class="n">SqlConnection</span><span class="p">(</span><span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">).</span><span class="n">EnsureOpen</span><span class="p">())</span>
<span class="p">{</span>
        <span class="kt">var</span> <span class="n">orders</span> <span class="p">=</span> <span class="n">connection</span><span class="p">.</span><span class="n">Query</span><span class="p">&lt;</span><span class="n">Order</span><span class="p">&gt;(</span><span class="n">o</span> <span class="p">=&gt;</span> <span class="n">o</span><span class="p">.</span><span class="n">CustomerId</span> <span class="p">==</span> <span class="m">10045</span><span class="p">);</span>
        <span class="k">for</span> <span class="p">(</span><span class="kt">var</span> <span class="n">i</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span> <span class="n">i</span> <span class="p">&lt;</span> <span class="m">100</span><span class="p">;</span> <span class="n">i</span><span class="p">++)</span>
        <span class="p">{</span>
                <span class="kt">var</span> <span class="n">order</span> <span class="p">=</span> <span class="n">orders</span><span class="p">.</span><span class="n">ElementAt</span><span class="p">(</span><span class="n">i</span><span class="p">);</span>
                <span class="n">order</span><span class="p">.</span><span class="n">Quantity</span> <span class="p">=</span> <span class="m">5</span><span class="p">;</span>
                <span class="n">order</span><span class="p">.</span><span class="n">LastUpdatedUtc</span> <span class="p">=</span> <span class="n">DateTime</span><span class="p">.</span><span class="n">UtcNow</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="n">connection</span><span class="p">.</span><span class="n">UpdateAll</span><span class="p">(</span><span class="n">orders</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div>
<p><strong>Note</strong>: The library uses the <cite>PrimaryKey</cite> as the default qualifier for <cite>UpdateAll</cite> operation. This call will throw an exception if the data entity does not have a <cite>primary key</cite> and the <cite>qualifiers</cite> were not provided.</p>
<p>The qualifiers can also be set when calling the <cite>UpdateAll</cite> operation.</p>
<div class="highlight-c# notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">connection</span> <span class="p">=</span> <span class="k">new</span> <span class="n">SqlConnection</span><span class="p">(</span><span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">).</span><span class="n">EnsureOpen</span><span class="p">())</span>
<span class="p">{</span>
        <span class="kt">var</span> <span class="n">orders</span> <span class="p">=</span> <span class="n">connection</span><span class="p">.</span><span class="n">Query</span><span class="p">&lt;</span><span class="n">Order</span><span class="p">&gt;(</span><span class="n">o</span> <span class="p">=&gt;</span> <span class="n">o</span><span class="p">.</span><span class="n">CustomerId</span> <span class="p">==</span> <span class="m">10045</span><span class="p">);</span>
        <span class="k">for</span> <span class="p">(</span><span class="kt">var</span> <span class="n">i</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span> <span class="n">i</span> <span class="p">&lt;</span> <span class="m">100</span><span class="p">;</span> <span class="n">i</span><span class="p">++)</span>
        <span class="p">{</span>
                <span class="kt">var</span> <span class="n">order</span> <span class="p">=</span> <span class="n">orders</span><span class="p">.</span><span class="n">ElementAt</span><span class="p">(</span><span class="n">i</span><span class="p">);</span>
                <span class="n">order</span><span class="p">.</span><span class="n">Quantity</span> <span class="p">=</span> <span class="m">5</span><span class="p">;</span>
                <span class="n">order</span><span class="p">.</span><span class="n">LastUpdatedUtc</span> <span class="p">=</span> <span class="n">DateTime</span><span class="p">.</span><span class="n">UtcNow</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="n">connection</span><span class="p">.</span><span class="n">UpdateAll</span><span class="p">(</span><span class="n">orders</span><span class="p">,</span> <span class="n">Field</span><span class="p">.</span><span class="n">From</span><span class="p">(</span><span class="s">&quot;CustomerId&quot;</span><span class="p">,</span> <span class="s">&quot;OrderId&quot;</span><span class="p">));</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div>
<p>With the qualifiers above, the <cite>UpdateAll</cite> operation is using both <cite>CustomerId</cite> and <cite>OrderId</cite> fields as the qualifiers. The SQL is something like below.</p>
<div class="highlight-c# notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="n">UPDATE</span> <span class="p">[</span><span class="n">Order</span><span class="p">]</span> <span class="n">SET</span> <span class="n">Quantity</span> <span class="p">=</span> <span class="n">@Quantity</span><span class="p">,</span> <span class="n">LastUpdatedUtc</span> <span class="p">=</span> <span class="n">@LastUpdatedUtc</span> <span class="n">WHERE</span> <span class="n">CustomerId</span> <span class="p">=</span> <span class="n">@CustomerId</span> <span class="n">AND</span> <span class="n">OrderId</span> <span class="p">=</span> <span class="n">@OrderId</span><span class="p">;</span>
</pre></div>
</td></tr></table></div>
<p><strong>Note</strong>: All fields are being updated when calling the typed-based method.</p>
<p>Certain columns can also be updated via table name calls.</p>
<div class="highlight-c# notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">connection</span> <span class="p">=</span> <span class="k">new</span> <span class="n">SqlConnection</span><span class="p">(</span><span class="s">@&quot;Server=.;Database=Northwind;Integrated Security=SSPI;&quot;</span><span class="p">).</span><span class="n">EnsureOpen</span><span class="p">())</span>
<span class="p">{</span>
        <span class="kt">var</span> <span class="n">orders</span> <span class="p">=</span> <span class="n">connection</span><span class="p">.</span><span class="n">Query</span><span class="p">&lt;</span><span class="n">Order</span><span class="p">&gt;(</span><span class="n">o</span> <span class="p">=&gt;</span> <span class="n">o</span><span class="p">.</span><span class="n">CustomerId</span> <span class="p">==</span> <span class="m">10045</span><span class="p">);</span>
        <span class="kt">var</span> <span class="n">updatables</span> <span class="p">=</span> <span class="k">new</span> <span class="n">List</span><span class="p">&lt;</span><span class="kt">dynamic</span><span class="p">&gt;();</span>
        <span class="k">for</span> <span class="p">(</span><span class="kt">var</span> <span class="n">i</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span> <span class="n">i</span> <span class="p">&lt;</span> <span class="m">100</span><span class="p">;</span> <span class="n">i</span><span class="p">++)</span>
        <span class="p">{</span>
                <span class="kt">var</span> <span class="n">order</span> <span class="p">=</span> <span class="n">orders</span><span class="p">.</span><span class="n">ElementAt</span><span class="p">(</span><span class="n">i</span><span class="p">);</span>
                <span class="n">updatables</span><span class="p">.</span><span class="n">Add</span><span class="p">(</span><span class="k">new</span>
                <span class="p">{</span>
                        <span class="n">Id</span> <span class="p">=</span> <span class="n">order</span><span class="p">.</span><span class="n">Id</span><span class="p">,</span>
                        <span class="n">Quantity</span> <span class="p">=</span> <span class="m">5</span><span class="p">,</span>
                        <span class="n">LastUpdatedUtc</span> <span class="p">=</span> <span class="n">DateTime</span><span class="p">.</span><span class="n">UtcNow</span>
                <span class="p">});</span>
        <span class="p">}</span>
        <span class="n">connection</span><span class="p">.</span><span class="n">UpdateAll</span><span class="p">(</span><span class="s">&quot;Order&quot;</span><span class="p">,</span>
                <span class="n">entities</span><span class="p">:</span> <span class="n">updatables</span><span class="p">,</span>
                <span class="n">fields</span><span class="p">:</span> <span class="n">Field</span><span class="p">.</span><span class="n">From</span><span class="p">(</span><span class="s">&quot;Id&quot;</span><span class="p">,</span> <span class="s">&quot;Quantity&quot;</span><span class="p">,</span> <span class="s">&quot;LastUpdatedUtc&quot;</span><span class="p">));</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div>
<p><strong>Why passing the fields arguments?</strong></p>
<p>Be aware on this behavior since this is an update operation. By default, the library will use the database columns of the <cite>Order</cite> entity. If the values to that fields has not been set, then <cite>UpdateAll</cite> operation will set it to <cite>null</cite> in the database. By setting the <cite>fields</cite> argument, it will only update the listed <cite>fields</cite> in the batch operations.</p>
<p><strong>Note</strong>: Use the table-name-based calls if the scenario is to only merge targetted columns.</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="rawsql.html" class="btn btn-neutral float-right" title="Raw SQL" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="orderfield.html" class="btn btn-neutral float-left" title="OrderField" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018, Michael Camara Pendon

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>